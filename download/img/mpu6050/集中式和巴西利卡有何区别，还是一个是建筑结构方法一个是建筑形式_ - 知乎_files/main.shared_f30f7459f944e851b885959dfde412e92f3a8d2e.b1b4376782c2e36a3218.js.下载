(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1073:function(e,t,n){"use strict";var o,r=n(4),a=n(33),i=n(49),c=n(1),l=n(0),s=n.n(l),u=n(19),d=n(474),f=n(43),p=n.n(f),h=n(24),b=n.n(h),g=n(435),m=n.n(g),v=n(40),O=n.n(v),j=n(53),k=n.n(j),C=n(207),x=n.n(C),y=n(28),A=n.n(y),w=n(21),L=n.n(w),S=n(23),B=n.n(S),z=n(31),T=n.n(z),I=n(63),N=n.n(I),E=n(907),R=n(3),G=n.n(R),P=n(12),M=n.n(P),_=n(88),D=n.n(_),W=n(138),K=n(6),V=n(2221),F=n.n(V),U=n(178),q=n(2769),H=n(2013),Z=n(2222),Q=n.n(Z),J=n(74),Y=n(44),X=n(895),$=n(35),ee=n(47),te=n(83),ne=(n(644),n(7)),oe=n(68),re=n.n(oe),ae=n(650),ie=n.n(ae),ce=n(52),le=n.n(ce),se=n(1734),ue=["text","target","url","image","imageWidth","imageHeight","component","className","size","children"],de=["inEditor","data-text","href","zaBlock"],fe=["root"],pe=["as","tag","className","html","clearBoth","richContentKey","root","Portal","useHooks"],he=["src","useWebP","useMp4","onRef","onLoadStateChange"],be=["html","css","options","linkCardInfo"],ge=["lazyLoadImageOptions","useGifPortalOption"];function me(e){return e.reduce((function(e,t){return t||(t={}),"function"==typeof t?function(n){return Object.assign(Object.assign({},e(n)),t(n))}:function(n){return Object.assign(Object.assign({},e(n)),t)}}),(function(e){return{}}))}var ve=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){"function"==typeof t?t(e):t&&(t.current=e)}))}};function Oe(e){var t=this;return e.length?function(n,o){for(var r=e.length-1,a=n;r>=0;)a=e[r].call(t,a,o),r--;return a}:N.a}var je=s.a.forwardRef((function(e,t){var n=D()(e,["entityType","entityData","notCommerce"]),o=n.text,r=n.target,a=n.url,i=n.image,l=n.imageWidth,s=n.imageHeight,u=n.component,d=n.className,f=n.size,p=n.children,h=T()(n,ue),b=function(e,t){if(e>0&&t>0){var n=e/t;if(n>1.2)return"180x120";if(n<=.8)return"120x160"}return"ipico"}(l,s),g=Object(W.imgUrl)(i,b);return Object(c.b)(u,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({ref:t,target:r,href:a,"data-draft-node":"block","data-draft-type":"link-card"},g&&{"data-image":g}),l&&{"data-image-width":l}),s&&{"data-image-height":s}),f&&{"data-size":f}),o!==a&&o&&{"data-text":o}),{},{className:M()("LinkCard new",d)},h),{},{children:p||Object(c.c)(c.a,{children:[Object(c.c)("span",{className:"LinkCard-contents",children:[Object(c.b)("span",{className:"LinkCard-title loading","data-text":!0}),Object(c.b)("span",{className:"LinkCard-desc loading"})]}),Object(c.b)("span",{className:"LinkCard-image LinkCard-image--default"})]})}))}));je.propTypes={component:G.a.oneOfType([G.a.string,G.a.func]),target:G.a.string,url:G.a.string.isRequired,text:G.a.string,image:G.a.string,imageWidth:G.a.oneOfType([G.a.string,G.a.number]),imageHeight:G.a.oneOfType([G.a.string,G.a.number])},je.defaultProps={component:"a",target:"_blank"};var ke={answer:"回答",article:"文章",zvideo:"视频",question:"问题",collection:"收藏夹",roundtable:"圆桌",topic:"话题"},Ce={voteupCount:"赞同",commentCount:"评论",playCount:"播放",followerCount:"关注",answerCount:"回答",visitCount:"浏览"},xe={answer:["voteupCount","commentCount"],article:["voteupCount","commentCount"],zvideo:["playCount","voteupCount"],question:["followerCount","answerCount"],collection:["visitCount","followerCount"],default:["followerCount","visitCount"]},ye=function(e){var t=e.twoLine,n=e.children;return Boolean(n)&&Object(c.b)("span",{className:M()("LinkCard-title",{"two-line":t}),children:n})},Ae=function(e){var t=e.data,n=t.objectType,o=(xe[n]||xe.default).map((function(e){var n=t[e];return"".concat(Object(U.cnNiceNumber)(n)).concat(Ce[e])})).filter(Boolean).join(" · ");return Object(c.c)("span",{className:"LinkCard-desc",children:[o,Object(c.b)("span",{className:"LinkCard-tag",children:ke[n]})]})},we=function(e){var t=e.url,n=Object(l.useMemo)((function(){var e=null,n=F()(t,!0);return"link.zhihu.com"===n.hostname&&(e=n.query.target),(e||t).replace(/^https?:\/\//,"")}),[t]);return Object(c.c)("span",{className:"LinkCard-desc",children:[Object(c.b)(q.a,{size:14,center:!0}),n]})},Le=function(e){var t=e.url,n=e.isVideo,o=e.ratio,r=void 0===o?1:o,a=e.onClick;return Boolean(t)&&Object(c.c)("span",{className:"LinkCard-image",style:{height:60*r},children:[Object(c.b)("img",{src:t,onClick:a,alt:n?"点击可播放视频":""}),n&&Object(c.b)("span",{className:"LinkCard-image--video",children:Object(c.b)(H.a,{size:10,center:!0})})]})},Se=function(e,t){var n=e.url,o=e.data,r=e.onClick,a=e.onClickImage,i=o.title,l=o.thumbnail,s=o.objectType;return Object(c.c)(c.a,{children:[Object(c.c)("span",{ref:t,className:"LinkCard-contents",onClick:r,children:[Object(c.b)(ye,{twoLine:!0,children:i}),s?Object(c.b)(Ae,{data:o}):Object(c.b)(we,{url:n})]}),Object(c.b)(Le,{url:l,isVideo:"zvideo"===s,onClick:a})]})},Be=s.a.forwardRef(Se),ze=function(e){var t=e.className,n=e.html;return n?Object(c.b)("span",{className:"LinkCard-richText ".concat(t),dangerouslySetInnerHTML:{__html:"<object>".concat(n,"</object>")}}):null},Te=function(e){var t=e.data,n=t.title,o=t.desc,r=t.url,a=t.image,i=t.ratio,l=t.isVideo;return Object(c.c)(c.a,{children:[Object(c.c)("span",{className:"LinkCard-contents",children:[Object(c.b)(ye,{twoLine:!0,children:n},"title"),Object(c.b)(ze,{className:"LinkCard-desc",html:o}),!o&&Object(c.b)(we,{url:r},"url")]}),Object(c.b)(Le,{url:a,ratio:i,isVideo:l})]})},Ie={ANSWER:"Answer",ARTICLE:"Column",ZVIDEO:"Zvideo",QUESTION:"Question",COLLECTION:"Collection",ROUNDTABLE:"Roundtable",SPECIAL:"Special",TOPIC:"Topic"},Ne=function(e){var t=Object(l.useMemo)((function(){return function(e){var t={};if(e.data){var n=Object(K.camelizeKeys)(JSON.parse(e.data)),o=n.source,r=void 0===o?{}:o,a=n.display,i=void 0===a?{}:a,c=n.zaData,l=void 0===c?{}:c,s=i.cardOpenUrl,u=i.title,d=i.content,f=i.desc,p=i.image||{};t={source:r,url:s,title:u,content:d,desc:f,image:p.imageUrl,ratio:p.ratio,isVideo:p.isVideo,zaAttachInfo:l.attachInfo}}return Object.assign(Object.assign(Object.assign({},t),e),{},{title:e.text||t.title,image:t.image||e.image})}(e)}),[e]),n=t.source,o=t.target,r=t.title,a=t.url,i=t.zaAttachInfo;return Object(c.b)(je,{notCommerce:!0,target:o,text:r,url:a,"data-za-attach-info":i,"data-za-content-type":Ie[null==n?void 0:n.contentType]||"Unknown",className:"static",children:Object(c.b)(Te,{data:t})})},Ee=/([-\w]+)(="([^"]+)"|='([^']+)')?/g,Re=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.decodeValue,r=void 0!==o&&o,a={};t=Ee.exec(e);){var i=t[1],c=t[3]||t[4];a[i]=(r?Pe(c):c)||""}return a},Ge=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#13;/g,"\r")}function Me(){return Math.max(window.innerHeight/10,100)}var _e=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=document.defaultView.getComputedStyle(t);if([n.overflow,n.overflowY,n.overflowX].some((function(e){return"scroll"===e||"auto"===e})))return t;t=t.parentNode||t.parentElement}return window};function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=_e(e),r=e.getBoundingClientRect().top+(o.pageYOffset||o.scrollTop||0)-(n?Me():0)-t;o.scrollTo({top:r,behavior:"smooth"})}var We=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,Ke=function(e){var t=e.target,n=e.url,o=e.component,r=e.className;return Object(c.b)(o,{target:t,href:n,"data-draft-node":"block","data-draft-type":"link-card","data-is-ecommerce":"1",className:M()("LinkCard",r),children:Object(c.c)("span",{className:"LinkCard-content LinkCard-ecommerceLoadingCard",children:[Object(c.b)("div",{className:"LinkCard-ecommerceLoadingCardAvatarWrapper",children:Object(c.b)("img",{src:"https://pic2.zhimg.com/v2-1b0bbef27f0496a58468f92d94c8a80e_l.png",className:"LinkCard-ecommerceLoadingCardNetwork"})}),Object(c.c)("div",{className:"LinkCard-ecommerceLoadingCardLoadingbar",children:[Object(c.b)("span",{}),Object(c.b)("span",{})]})]})})};Ke.defaultProps={component:"a",target:"_blank"};var Ve=/<a\b([^>]*BIZ(=|%3D)ECOMMERCE[^>]*)>(.*?)<\/a>/g;var Fe=function(){function e(t){var n,o,r,a=this;L()(this,e),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.url||(a.url=e),e!==a.url)throw new Error("mismatch url\n".concat(e,"\n").concat(a.url),e,a.url);return new Promise((function(e,n){a.addToQueue({options:t,resolve:e,reject:n})}))},(o="fetch")in(n=this)?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,this.instance=null,this.customFetch=t,this.delay=200,this.maxDelay=1e3,this.url="",this.queueMaxLength=10,this.queue=[],this.startTime=Date.now(),this.timeout=null,this.initialized=!1}var t;return B()(e,[{key:"initConfig",value:function(e){var t=e.delay,n=e.maxDelay,o=e.maxBatchCount;t&&(this.delay=t),n&&(this.maxDelay=n),o&&(this.maxBatchCount=o),this.initialized=!0}},{key:"buildFetchParams",value:function(e){var t=A()(e,1)[0].options,n=e.reduce((function(e,t){var n,o;return(null===(n=(o=t.options).dataBuilder)||void 0===n?void 0:n.call(o,e,t))||e}),{}),o=this.url,r=!t.method||"GET"===t.method.toUpperCase();if(r){var a=F()(o,!0);a.query=Object.assign(Object.assign({},a.query),n),o=a.toString()}return[o,Object.assign(Object.assign({},t),{},{data:r?null:Object.assign(Object.assign({},t.data),n)})]}},{key:"doFetch",value:(t=x()(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.queue.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.queue,this.queue=[],e.prev=4,e.next=7,this.customFetch.apply(this,k()(this.buildFetchParams(t)));case 7:n=e.sent,t.forEach((function(e){var t=e.options,o=e.resolve;t.resultBuilder?o(t.resultBuilder(n)):o(n)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),t.forEach((function(t){return t.reject(e.t0)}));case 14:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(){return t.apply(this,arguments)})},{key:"addToQueue",value:function(e){var t=this;this.initialized||this.initConfig(e.options),clearTimeout(this.timeout),(Date.now()-this.startTime>this.maxDelay||this.queue.length>=this.maxBatchCount)&&(this.startTime=Date.now(),this.doFetch()),this.queue.push(e),setTimeout((function(){t.startTime=Date.now(),t.doFetch()}),this.delay)}}]),e}(),Ue=null,qe=function(){throw new Error("Not implemented")},He=function(){return function(e){return function(t,n){return Ue||(Ue=new Fe(e)),Ue.fetch(t,n)}}(function(e){return function(){var t=x()(O.a.mark((function t(n,o){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,o);case 2:return r=t.sent,t.t0=K.camelizeKeys,t.next=6,r.json();case 6:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}("undefined"!=typeof fetch?fetch:qe))},Ze={},Qe=function(e,t,n){var o=e["data-text"],r=e.href,a=e.zvideoLinkCardProps;Object(l.useEffect)((function(){n&&Object(X.onViewedOnce)(t.current,(function(){return e=t.current,void $.a.trackCardShow(e,{id:7844},{button:{text:"inlinezvideo"}});var e}))}),[n,t]);var i=Object(Y.d)((function(e){!function(e,t,n){var o;$.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,{title:o,url:r,video:{}})})),c=Object(Y.d)((function(e){!function(e,t,n){var o;$.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,a,{title:o,url:r})}));return n?{handleImageClick:i,handleInfoClick:c}:{}},Je={answer:"Answer",article:"Column",zvideo:"Zvideo",question:"Question",collection:"Collection",roundtable:"Roundtable",topic:"Topic"},Ye=s.a.forwardRef((function(e,t){var n=D()(e,["zvideoLinkCardProps"]),o=n.inEditor,r=n["data-text"],a=n.href,i=n.zaBlock,s=T()(n,de),u=Object(l.useRef)(),d=function(e){var t=Object(l.useRef)(0),n=e.inEditor,o=e["data-offset-key"],r=e["data-text"],a=e["data-image"],i=e.href,c=Object(l.useState)((function(){return n&&Ze[o]||null})),s=A()(c,2),u=s[0],d=s[1],f=Object(Y.f)({once:!0}),p=A()(f,2),h=p[0],b=p[1],g=Object(Y.d)((function(e){var t=e||u;if(!t||0===Object.keys(t).length)return{objectType:null,title:r||i,thumbnail:a};t.title=r||t.title||i,t.thumbnail=a||t.thumbnail;var c=Object.assign(Object.assign({},t),{},{cached:!0});return n&&(Ze[o]=c),c})),m=Object(Y.d)(He()),v=Object(Y.d)(x()(O.a.mark((function e(){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.current+=1,e.prev=1,e.next=4,m("https://www.zhihu.com/api/v4/link_card_infos",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},dataBuilder:function(e){return e.urls="".concat(e.urls?e.urls+",":"").concat(i),e},resultBuilder:function(e){return e[i]}});case 4:n=e.sent,d(g(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.current<=1?v():d(g());case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))));return Object(l.useEffect)((function(){!b||u&&u.cached||v()}),[b,u,v]),Object(l.useEffect)((function(){n&&d(g())}),[n,g,r,a]),[h,u]}(e),f=A()(d,2),p=f[0],h=f[1],b=Qe(e,u,"zvideo"===(null==h?void 0:h.objectType)),g=b.handleImageClick,m=b.handleInfoClick,v=Object(l.useCallback)(ve(t,p,u),[]),j=o?Be:J.a,k=o?null:{as:Be,shouldTrackShow:!0,zaText:!0,zaType:"Button",zaAction:"OpenUrl",zaBlock:i,extra:{link:{url:a}},"data-za-module":"Content"},C=Object(c.b)(j,Object.assign(Object.assign({},k),{},{url:a,data:h,onClick:m,onClickImage:g}));return Object(c.b)(je,Object.assign(Object.assign({ref:v,text:r,url:a,component:"a"},s),{},{children:Boolean(h)&&Object(c.b)(J.b,{content:{type:Je[h.objectType]||"Unknown"},children:C})}))})),Xe=function(e){return function(t){var n=Object(l.useState)(null),o=A()(n,2),r=o[0],a=o[1],i=e.idAttr,s=e.selector,u=e.component,d=e.targetClassName,f=e.cardDataFilter,p=e.getCardProps,h=t.root,b=T()(t,fe),g=i&&s&&d&&Object(l.useCallback)((function(e){return function(e){var t=e.idAttr,n=e.targetClassName;return function(e){var o=e.getAttribute(t),r=document.createElement("div");return r.className=n,e.parentNode.replaceChild(r,e),{data:{id:o},target:r}}}({idAttr:i,targetClassName:d})(e)}),[i,d]),m=Object(l.useMemo)((function(){return g?function(e){return Array.from(e.querySelectorAll(s)).map(g)}:N.a}),[g,h,s]);return Object(l.useEffect)((function(){if(h||s&&f){var e=(f||m)(h).map((function(e){var t=e.data,n=e.target,o=null;return"function"==typeof p&&(o=p(t)),Object(ee.createPortal)(Object(c.b)(u,Object.assign(Object.assign({id:t.id},o),b),t.id),n)}));e.length>0&&a(e)}}),[h]),r}},$e=Xe({cardDataFilter:function(e){return Array.from(e.querySelectorAll("a.LinkCard[data-draft-type=link-card]:not([data-is-ecommerce])")).map((function(e){var t,n=(t=e.attributes,Array.from(t).reduce((function(e,t){return"class"===t.name?e.className=t.value:e[t.name]=t.value,e}),{})),o=document.createElement("div");return o.className="RichText-LinkCardContainer",e.parentNode.replaceChild(o,e),{data:n,target:o}}))},getCardProps:function(e){return e.href&&e.href.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)?e.zaBlock="ZTextZVideoLinkCard":e.zaBlock="ZTextLinkCard",e},component:Ye}),et=function(e){return{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:"inherit",height:80,boxSizing:"border-box",background:e.colorMod(e.colors.GBK10A).alpha(.88),color:e.colors.GBK08A}},tt=function(e){return{width:60,height:60,background:e.colors.GBK09A,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:6,marginRight:10}},nt=function(e){return{height:60,flex:1,display:"flex",flexDirection:"column",span:{height:16,display:"inline-block",background:e.colors.GBK09A},"span:nth-of-type(1)":{width:60,marginBottom:4},"span:nth-of-type(2)":{width:127}}},ot=function(e){return{".LinkCard.old":{position:"relative",display:"block",margin:"1em auto",width:390,boxSizing:"border-box",borderRadius:12,maxWidth:"100%",overflow:"hidden","&,&:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"}},".LinkCard-ecommerceLoadingCard":et(e),".LinkCard-ecommerceLoadingCardAvatarWrapper":tt(e),".LinkCard-ecommerceLoadingCardNetwork":{width:20,height:20},".LinkCard-ecommerceLoadingCardLoadingbar":nt(e)}},rt=function(e){return{position:"relative",display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",width:390,minHeight:84,borderRadius:8,maxWidth:"100%",overflow:"hidden",margin:"16px auto",padding:"12px 12px 9px 12px",backgroundColor:e.colors.GBK10A,"&, &:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"},".LinkCard-contents":{display:"block",flex:"1 1 auto",position:"relative",".loading":{height:14,background:e.colors.GBK09A,borderRadius:7},"&.withTitle":{marginBottom:3}},".LinkCard-title":Object.assign(Object.assign({display:"block",fontSize:15,fontWeight:500,lineHeight:1.4,marginBottom:2,color:e.colors.GBK02A},Object(te.d)(1)),{},{"&.two-line":Object.assign({lineHeight:"20px"},Object(te.d)(2)),"&.loading":{marginBottom:8,width:"80%","&.withTitle":{marginBottom:6}},"&.loadingTitle":{marginBottom:5}}),".LinkCard-excerpt":Object.assign(Object.assign({display:"block",textOverflow:"ellipsis",fontSize:13,lineHeight:"18px",color:e.colors.GBK06A,marginBottom:4},Object(te.d)(1)),{},{".LinkCard-author":{color:e.colors.GBK03A}}),".LinkCard-desc":Object.assign(Object.assign({display:"block",fontSize:13,height:18,lineHeight:"18px",color:e.colors.GBK06A,wordBreak:"break-all"},Object(te.d)(1)),{},{".LinkCard-tag,.tag":{display:"inline-block",fontSize:11,marginLeft:8,padding:"0 4px",borderRadius:3,background:e.colorMod(e.colors.GBK08A).alpha(.3)},"&.loading":{width:"40%"},svg:{marginRight:2}}),".LinkCard-image":{flex:"0 0 auto",backgroundColor:e.colors.GBK09A,backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"block",width:60,height:60,marginLeft:20,objectFit:"cover",borderRadius:"inherit",overflow:"hidden","&.LinkCard-image--default":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.colors.GBK09A,color:e.colors.GBK08A,svg:{color:e.colors.GBK06A}},img:{width:"100%",height:"100%",objectFit:"cover"},".LinkCard-image--video":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",width:24,height:24,borderRadius:12,background:e.colorMod(e.colors.GBK99C).alpha(.9),pointerEvents:"none",svg:{color:e.colors.GBK03A}}},".LinkCard-richText":{".text":{color:e.colors.GBK03A},".bold":{fontWeight:e.fontWeights.bold},".tag":{marginLeft:4}}}},at=function(e){return{".LinkCard.new":rt(e)}},it=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,Object.assign({credentials:"include",headers:{"X-Requested-With":"Fetch"}},t)).then((function(e){return e.json()}))},ct=function(e){return Object.assign(Object.assign({},ot(e)),at(e))},lt=function(e){return Object.assign(Object.assign({},at(e)),ot(e))},st="function"==typeof queueMicrotask?queueMicrotask:function(e){return Promise.resolve().then(e)},ut=function(e){var t=Object(l.useRef)(null);Object(l.useEffect)((function(){if(e)return st((function(){e&&(t.current=function(e){var t=new IntersectionObserver((function(e){e.forEach(n)}),{threshold:[.1]});function n(e){if(0!==e.intersectionRatio){var n=e.target;n.dataset.zaDetailViewId=n.cardShowViewId,$.a.trackCardShow(n,{},{link:{url:n.href}}),t.unobserve(n),n.clickViewId&&(n.dataset.zaDetailViewId=n.clickViewId)}}return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'},{cardShowViewId:7692,selector:"a.FileLinkCard .FileLinkCard-info"},{cardShowViewId:9744,selector:".Catalog"}].forEach((function(n){var o=n.selector,r=n.cardShowViewId,a=n.clickViewId;Array.from(e.querySelectorAll(o)).forEach((function(e){e.cardShowViewId=r,e.clickViewId=a,t.observe(e)}))})),function(){t.disconnect()}}(e))})),function(){t.current&&t.current()}}),[e])},dt=function(e){return{elementLocation:{type:"Button",content:{type:e.dataset.zaContentType}}}},ft=function(e){return{attachedInfoBytes:e.dataset.zaAttachInfo}},pt=[{selector:"a.external, a.internal",zaBlock:"ZTextLink"},{selector:"a.member_mention, a.UserLink-link",zaBlock:"ZTextMention"},{selector:"a.video-box",zaBlock:"ZTextVideoCard"},{selector:'a.LinkCard.old[data-draft-type="link-card"]',zaBlock:"ZTextLinkCard"},{selector:'a.LinkCard.new.static[data-draft-type="link-card"]:not([data-za-content-type="Zvideo"])',zaBlock:"ZTextLinkCard",viewInfoBuilder:dt,extraInfoBuilder:ft},{selector:'a.LinkCard.new.static[data-draft-type="link-card"][data-za-content-type="Zvideo"]',zaBlock:"ZTextZVideoLinkCard",viewInfoBuilder:dt,extraInfoBuilder:ft},{selector:"a.FileLinkCard",zaBlock:"ZTextFileLinkCard"}],ht=function(e){var t,n,o=e.element,r=e.config,a=null===(t=r.viewInfoBuilder)||void 0===t?void 0:t.call(r,o,r),i=Object.assign({elementLocation:{type:"Button"},block:r.zaBlock},a),c=Object.assign({action:"OpenUrl",elementLocation:{type:"Button"},block:r.zaBlock,eventType:"Click"},a),s=Object.assign({link:{url:o.href}},null===(n=r.extraInfoBuilder)||void 0===n?void 0:n.call(r,o,r)),u=Object(J.i)().trackEvent,d=Object(J.h)(i,s),f=Object(Y.d)((function(e){u(c,s),"ZTextLinkCard"===r.zaBlock&&o.dataset.isEcommerce&&e.preventDefault()}));return Object(l.useEffect)((function(){return o.addEventListener("click",f),function(){o.removeEventListener("click",f)}}),[]),Object(l.useEffect)((function(){return d(o),function(){return d(null)}}),[]),null},bt=function(e){var t=e.root,n=Object(l.useState)([]),o=A()(n,2),r=o[0],a=o[1];return Object(l.useEffect)((function(){if(t){var e=[];pt.forEach((function(n){var o=n.selector;Array.from(t.querySelectorAll(o)).forEach((function(t){e.push({el:t,config:n})}))})),a(e)}}),[t]),Object(c.b)(l.Fragment,{children:r.map((function(e,t){var n=e.el,o=e.config;return Object(c.b)(ht,{element:n,config:o},t)}))})},gt=/<p><br><\/p>/g,mt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBK05A)}},vt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(t," ").concat(e.colors.GBL07A)}},Ot=function(e){return{color:e.colors.GBL07A,"&:hover":vt(e)}},jt=Object(ne.h)(o||(o=m()(["\n   from {\n    opacity: 0;  \n   }\n   \n   to {\n    opacity: 1;\n  }\n"]))),kt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[data-focus-visible]";return b()({outline:"none",transition:"box-shadow 0.3s"},"html".concat(t," &"),{boxShadow:"0 0 0 2px ".concat(e.colors.GBK99A,", 0 0 0 4px ").concat(e.colorMod(e.colors.GBL01A).alpha(.3))})},Ct={"--zFontSansSerif":"-apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei', 'Source Han Sans SC', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', sans-serif","--zFontMonospace":"Menlo, Monaco, Consolas, 'Andale Mono', 'lucida console', 'Courier New', monospace"},xt=[function(e){return e?e.replace(gt,'<p class="ztext-empty-paragraph"><br /></p>'):e}],yt=Object(l.forwardRef)((function(e,t){var n,o=e.as,r=e.tag,a=e.className,i=e.html,l=e.clearBoth,s=void 0!==l&&l,u=e.richContentKey,d=e.root,f=e.Portal,p=e.useHooks,h=T()(e,pe),b=Oe(xt);p(d);var g=null!==(n=null!=o?o:r)&&void 0!==n?n:"div";return Object(c.c)(c.a,{children:[f&&Object(c.b)(f,{root:d}),Object(c.b)(g,Object.assign({ref:t,css:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},function(e){return{"a.UserLink-link":Ot(e),"lazy[data-lazy-status]":{backgroundColor:e.colors.GBK10A},'lazy[data-lazy-status="ok"]':{backgroundColor:"transparent",animation:"".concat(jt," 0.5s ease-in")}}}(e)),function(e){return{wordBreak:"break-word",lineHeight:"1.6","> *:first-of-type":{marginTop:0},"> :last-child":{marginBottom:0},"h1,h2":{clear:"left",marginTop:"calc((".concat("1.4em"," * 2) / 1.2)"),marginBottom:"calc(".concat("1.4em"," / 1.2)"),fontSize:"1.2em",lineHeight:1.5,fontWeight:e.fontWeights.bold},"h3,h4,h5,h6":{clear:"left",marginTop:"calc((".concat("1.4em"," * 1.5) / 1.1)"),marginBottom:"calc(".concat("1.4em"," / 1.1)"),fontSize:"1.1em",lineHeight:"1.5",fontWeight:e.fontWeights.bold},u:Object.assign({textDecoration:"none"},mt(e,"dashed")),b:{fontWeight:e.fontWeights.bold},sup:{fontSize:"0.8em"},"sup[data-draft-type='reference']":{color:e.colors.GBL07A},"a:focus":kt(e),"a.ztext-link,a.internal,a.external":Object.assign(Object.assign({textDecoration:"none",cursor:"pointer"},mt(e)),{},{"&:hover":Object.assign({color:e.colors.GBL07A},vt(e))," > .ellipsis::after":{content:"'...'"},"> .invisible":{font:"0/0 a",color:"transparent",textShadow:"none",backgroundColor:"transparent"},u:{border:"none"}}),"a.member_mention":Ot(e),p:{margin:"".concat("1.4em"," 0")},"p.ztext-empty-paragraph":{margin:"calc((".concat("2.8em","- (").concat("1.4em"," * 2 + 1.6em)) / 2) 0"),"+ .ztext-empty-paragraph":{margin:"".concat("1.4em"," 0")}},hr:{margin:"4em auto",width:"240px",maxWidth:"100%",border:"none",borderTop:"1px solid ".concat(e.colors.GBK08A)},"img[eeimg]":Object.assign({maxWidth:" 100%",verticalAlign:"middle"},e.isDarkMod&&{filter:"invert(1)"}),'img[eeimg="1"]':{margin:"0 3px",display:"inline-block"},'img[eeimg="2"]':{margin:"".concat("1.4em"," 0"),display:"block"},blockquote:{margin:"".concat("1.4em"," 0"),paddingLeft:"1em",color:e.colors.GBK04A,borderLeft:"3px solid ".concat(e.colors.GBK08A)},"ol,ul":{margin:"".concat("1.4em"," 0"),padding:0,"ol,ul":{margin:0},"> ol, > ul":{display:"table-row","&::before":{display:"table-cell",content:"''"}}},ul:{display:"table","&>li":{display:"table-row",listStyle:"none","&::before":{display:"table-cell",content:"'•  '",whiteSpace:"pre"}}},ol:{display:"table",counterReset:"ol","> li":{display:"table-row",listStyle:"none","&::before":{display:"table-cell",textAlign:"right",counterIncrement:"ol",content:"counter(ol) '. '",whiteSpace:"pre"}}},"ol ol":{counterReset:"ol2","li::before":{counterIncrement:"ol2",content:"counter(ol2) '. '"}},"ol ol ol":{counterReset:"ol3","li::before":{counterIncrement:"ol3",content:"counter(ol3) '. '"}},"ol ol ol ol":{counterReset:"ol4","li::before":{counterIncrement:"ol4",content:"counter(ol4) '. '"}},figure:{margin:"".concat("1.4em"," 0"),".content_image,.origin_image":{margin:"0 auto"},figcaption:{marginTop:"calc(0.6em / 0.9)",padding:"0 1em",fontSize:"0.9em",lineHeight:"1.5",textAlign:"center",color:e.colors.GBK06A},"& + figure":{marginTop:"calc(".concat("1.4em"," * 1.6)")},"&[data-size='small'],&:not([data-size]) > [data-size='small']":{clear:"both"},"&[data-size='left'],&:not([data-size]) > [data-size='left']":{float:"left",margin:"0 20px 20px 0",maxWidth:"33%"},"&[data-size='right'],&:not([data-size]) > [data-size='right']":{float:"right",margin:"0 0 20px 20px",maxWidth:"33%"},"&[data-size='collapse']":{marginBottom:0,"& + figure":{marginTop:0}}},".content_image, .origin_image":{display:"block",maxWidth:"100%",margin:"".concat("1.4em"," auto"),"&[data-size='small']":{maxWidth:"40%"},"&.zh-lightbox-thumb":{cursor:"zoom-in"}},code:{margin:"0 2px",padding:"3px 4px",borderRadius:"3px",fontFamily:Ct.zFontMonospace,fontSize:"0.9em",backgroundColor:e.colors.GBK10A},pre:{margin:"".concat("1.4em"," 0"),padding:"calc(0.8em / 0.9)",fontSize:"0.9em",wordBreak:"initial",wordWrap:"initial",whiteSpace:"pre",overflow:"auto",WebkitOverflowScrolling:"touch",background:e.colors.GBK10A,borderRadius:"4px",code:{margin:0,padding:0,fontSize:"inherit",borderRadius:0,backgroundColor:"inherit"}},"li pre":{whiteSpace:"pre-wrap"},"table[data-draft-type='table']":{borderCollapse:"collapse",fontSize:"15px",margin:"".concat("1.4em"," auto"),maxWidth:"100%",tableLayout:"fixed",textAlign:"left",width:"100%","&[data-size='small']":{minWidth:"260px",width:"40%"},"&[data-row-style='striped'] tr:nth-of-type(2n + 1)":{background:e.colors.GBK10A},"td,th":{border:"1px solid ".concat(e.colors.GBK08A),lineHeight:"24px",height:"24px",padding:"3px 12px"},th:{background:e.colors.GBK09A,color:e.colors.GBK02A,fontWeight:500}},"& .video-box, & .link-box":{position:"relative",display:"flex",justifyContent:"space-between",margin:"".concat("1.4em"," 0"),overflow:"auto",whiteSpace:"normal",cursor:"pointer",border:"solid 1px ".concat(e.colors.GBK09A),borderRadius:"4px"}}}(e)),function(e){return{"& .highlight":{margin:"1em 0",pre:{margin:0},".hll":{backgroundColor:e.colors.GBK12A},".c":{fontStyle:"italic",color:e.colors.GBK06A},".err":{color:e.colors.GRD03A},".k":{fontWeight:e.fontWeights.bold},".o":{fontWeight:e.fontWeights.bold},".cm":{fontStyle:"italic",color:e.colors.GBK06A},".cp":{fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".c1":{fontStyle:"italic",color:e.colors.GBK06A},".cs":{fontStyle:"italic",fontWeight:e.fontWeights.bold,color:e.colors.GBK06A},".gd":{color:e.colors.GRD01A},".ge":{fontStyle:"italic"},".gr":{color:e.colors.GRD03A},".gh":{color:e.colors.GBK06A},".gi":{color:"#12b370"},".go":{color:e.colors.GBK05A},".gp":{color:e.colors.GBK04A},".gs":{fontWeight:e.fontWeights.bold},".gu":{color:e.colors.GBK06A},".gt":{color:e.colors.GRD03A},".kc":{fontWeight:e.fontWeights.bold},".kd":{fontWeight:e.fontWeights.bold},".kn":{fontWeight:e.fontWeights.bold},".kp":{fontWeight:e.fontWeights.bold},".kr":{fontWeight:e.fontWeights.bold},".kt":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".m":{color:e.colors.GBL01A},".s":{color:e.colors.GRD03A},".na":{color:e.colors.GBL01A},".nb":{color:e.colors.GBL01A},".nc":{fontWeight:e.fontWeights.bold,color:e.colors.GBL07A},".no":{color:e.colors.GBL01A},".ni":{color:e.colors.GRD07A},".ne":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nf":{fontWeight:e.fontWeights.bold,color:e.colors.GRD03A},".nn":{color:e.colors.GBK04A},".nt":{color:e.colors.GBL07A},".nv":{color:e.colors.GBL01A},".ow":{fontWeight:e.fontWeights.bold},".w":{color:e.colors.GBK07A},".mf":{color:e.colors.GBL01A},".mh":{color:e.colors.GBL01A},".mi":{color:e.colors.GBL01A},".mo":{color:e.colors.GBL01A},".sb":{color:e.colors.GRD03A},".sc":{color:e.colors.GRD03A},".sd":{color:e.colors.GRD03A},".s2":{color:e.colors.GRD03A},".se":{color:e.colors.GRD03A},".sh":{color:e.colors.GRD03A},".si":{color:e.colors.GRD03A},".sx":{color:e.colors.GRD03A},".sr":{color:e.colors.GYL02A},".s1":{color:e.colors.GRD03A},".ss":{color:e.colors.GRD03A},".bp":{color:e.colors.GBK06A},".vc":{color:e.colors.GBL01A},".vg":{color:e.colors.GBL01A},".vi":{color:e.colors.GBL01A},".il":{color:e.colors.GBL01A},"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-thumb:horizontal":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.5),borderRadius:"6px","&:hover":{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.6)}}}}}(e)),s&&{"&::before, &::after":{clear:"both",content:'""',display:"block"}})},className:M()("RichText","ztext",a,{"RichText--clearBoth":s}),dangerouslySetInnerHTML:{__html:b(i)}},h),u||i)]})}));yt.propTypes={as:G.a.string,tag:G.a.string,html:G.a.string.isRequired,clearBoth:G.a.bool,ref:G.a.func,Portal:G.a.func,useHooks:G.a.func},yt.defaultProps={useHooks:N.a};var At=s.a.memo(yt),wt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.rootMargin,r=n.threshold,a=n.once,i=void 0===a||a;e=Array.isArray(e)?e:e?[e]:[];var c=Object(l.useRef)(null),s=Object(Y.d)(t);Object(l.useEffect)((function(){if(e.length)return c.current&&e.forEach((function(e){return c.current.unobserve(e)})),c.current=new IntersectionObserver((function(e){e.forEach((function(e){e.intersectionRatio>0&&(s(e),i&&c.current.unobserve(e.target))}))}),{rootMargin:o,threshold:r}),e.forEach((function(e){return c.current.observe(e)})),function(){e.forEach((function(e){return c.current.unobserve(e)}))}}),[e,o,JSON.stringify(r),i])},Lt=n(131);var St="function"==typeof Image,Bt={},zt=St?Lt((function(e){return new Promise((function(t){return n=e,o=function(e,n){Bt[e]=n,t(n)},(r=new Image).onload=function(){var e=r.width>0&&r.height>0;o(n,e)},r.onerror=function(){o(n,!1)},void(r.src="data:image/webp;base64,"+{lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"}[n]);var n,o,r}))})):function(){return Promise.resolve(!1)},Tt=function(e){var t=Bt[e],n=Object(l.useState)(t),o=A()(n,2),r=o[0],a=o[1];return St&&void 0===t&&zt(e).then(a),r},It=re()((function(){return/Mobile/.test(navigator.userAgent)}));function Nt(e,t){var n={monitor:{type:"Event",imgResourceErrorInfo:{error_description:t,img_url:e,img_from:"web"}}};$.a.trackMonitor({name:t},n)}var Et=function(e){var t=e.onLoadStateChange,n=e.enableWebP,o=e.size,r=e.quality;return function(e){var a=e.target,i=function(e){var t=e.image,n=e.enableWebP,o=e.size,r=e.quality,a=void 0===r?80:r,i=t.dataset,c=i.actualsrc,l=i.actualgif;return n&&l&&l.match(/.gif$/i)?c:(o||(o="720w",!It()&&window.devicePixelRatio>=1.5&&(o="1440w"),It()&&window.devicePixelRatio*window.innerWidth>=1080&&(o="1440w")),Object(W.imgUrl)(c,{quality:a,size:o}))}({image:a,enableWebP:n,size:o,quality:r});if(n&&(i=function(e){return e.replace(/\.(jpg|png|jpeg|gif)/,".webp")}(i)),a.src=i,a.complete)a.dataset.lazyStatus="ok";else{t&&a.addEventListener("loadstart",(function(){t("loadstart",i)})),a.dataset.lazyStatus="loading";var c=setTimeout((function(){a.complete||Nt(a.url,"image_web_timeout_image"),t&&t("timeout",i)}),15e3);a.addEventListener("load",(function(){a.dataset.lazyStatus="ok",clearTimeout(c),Nt(a.url,"image_web_success_image"),t&&t("load",i)})),a.addEventListener("error",(function(){clearTimeout(c),Nt(a.url,"image_web_fail_image"),t&&t("error",i)}))}}},Rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.useWebP,o=void 0===n||n,r=t.disabled,a=void 0!==r&&r,i=t.onLoadStateChange,c=t.size,s=t.quality,u=Object(l.useState)([]),d=A()(u,2),f=d[0],p=d[1],h=Tt("lossless");wt(f,Et({onLoadStateChange:i,enableWebP:h&&o,size:c,quality:s}),{rootMargin:"300px"}),Object(l.useEffect)((function(){if(e&&!a){var t=Array.from(e.querySelectorAll("img.lazy:not([data-thumbnail])"));t.length&&p(t)}}),[e,a])},Gt=function(e,t){$.a.trackEvent(e,{action:"StatusReport",element:"Card"},{status:{result:t}})},Pt=function(e,t){var n,o,r;null===(n=window)||void 0===n||null===(o=n.Raven)||void 0===o||null===(r=o.captureException)||void 0===r||r.call(o,e,{fingerprint:["gif2mp4"],extra:t})},Mt=function(e){var t=e.src,n=e.useWebP,o=void 0===n?"auto":n,r=e.useMp4,a=void 0!==r&&r,i=e.onRef,s=e.onLoadStateChange,u=T()(e,he),d=Object(l.useState)(""),f=A()(d,2),h=f[0],b=f[1],g=Object(l.useState)(null),m=A()(g,2),v=m[0],O=m[1],j=Object(l.useState)(Date.now()),k=A()(j,2),C=k[0],x=k[1],y=Object(l.useState)(!1),w=A()(y,2),L=w[0],S=w[1],B=Object(l.useState)(null),z=A()(B,2),I=z[0],E=z[1],R=Tt("animation"),G=Object(l.useCallback)((function(){var e=(Object(ae.imgPathParse)(t)||{}).hash;a&&Object(X.onViewedOnce)(v,(function(){var t;(t=e,fetch("https://api.zhihu.com/gif2mp4/".concat(t),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then((function(e){return e.json()}))).then((function(e){var t,n,o=e.playlist,r=(null==o||null===(t=o.SD)||void 0===t?void 0:t.play_url)||(null==o||null===(n=o.LD)||void 0===n?void 0:n.play_url);r&&p.a.increment("Gif2Mp4Player.mp4.fetch.success.count"),b(r)})).catch(N.a)}))}),[v,t,a]);Object(l.useEffect)(G,[t,a,v]),Object(l.useEffect)((function(){v&&$.a.setModule(v,{module:"GifItem"})}),[v]),wt(v,(function(){$.a.trackCardShow(v,{element:"Card"})})),Object(Y.l)((function(){p.a.increment("Gif2Mp4Player.mp4.play.failure.count"),Pt(new Error("Gif2Mp4 play timeout"),{src:t,videoUrl:h}),S(!1)}),L?2e3:null),Object(Y.l)((function(){p.a.increment("Gif2Mp4Player.mp4.play.success.count"),p.a.timing("Gif2Mp4Player.mp4.first_frame_time",Date.now()-C-100),S(!1),E(null)}),I);var P=ie()(t,{extension:("auto"===o?R:o)?"webp":"gif"});return Object(c.b)(se.a,Object.assign({videoUrl:h,src:P,onRef:Object(l.useCallback)(ve(i,O),[]),onPlayChange:function(e){e||(x(Date.now()),h&&(p.a.increment("Gif2Mp4Player.mp4.click.count"),S(!0)),$.a.trackEvent(v,{action:"Click",element:"Image"}))},onLoadStart:function(){if(h){var e=le.a.parse(h).expiration;e&&Number(e)<Date.now()/1e3+900&&G()}x(Date.now()),s&&s("loadstart",P)},onSuccess:function(){Gt(v,"Success"),h?L&&E(100):p.a.timing("Gif2Mp4Player.gif.first_frame_time",Date.now()-C),s&&s("load",P)},onFailed:function(e){Gt(v,"Fail"),h&&(L&&(p.a.increment("Gif2Mp4Player.mp4.play.failure.count"),S(!1),E(null)),Pt(e,{videoUrl:h,src:t})),s&&s("error",P)}},u))},_t=function(e){var t=e.dataset,n=t.thumbnail,o={src:n,poster:n,size:t.size},r=document.createElement("div");return r.className="RichText-gifPlaceholder",e.parentNode.replaceChild(r,e),{data:o,target:r}},Dt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.Component,o=void 0===n?Mt:n,r=Object(l.useState)(null),a=A()(r,2),i=a[0],s=a[1];return Object(l.useEffect)((function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));if(t.length){var n=t.map((function(e){return _t(e)})).map((function(e,t){var n=e.data,r=e.target;return Object(ee.createPortal)(Object(c.b)(o,Object.assign({},n),t),r)}));s(n)}}}),[e]),i},Wt=Oe([function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.linkCardInfo;return e?e.replace(We,(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Re(t,{decodeValue:!0}),a=r.target,i=void 0===a?"_blank":a,l=r.href,s=void 0===l?"":l,u=r["data-image"],d=r["data-image-width"],f=r["data-image-height"],p=r["data-entity-type"],h=r["data-entity-data"],b=r["data-size"],g=r["data-is-ecommerce"];if(g)return e;var m=o.replace(/<[^>]*>/g,"");m=Pe(m),s.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)&&!m&&(m="知乎视频");var v=n?Ne:je;return Object(E.renderToStaticMarkup)(Object(c.b)(v,Object.assign({text:m,url:s,target:i,image:u,imageWidth:d,imageHeight:f,entityType:p,entityData:Ge(h),size:b},n&&{data:n[s]})))})):e},function(e){return e?e.replace(Ve,(function(e,t){var n=Re(t,{decodeValue:!0}),o=n["data-draft-type"],r=n.href,a=n.class;return"link-card"!==o?e:Object(E.renderToStaticMarkup)(Object(c.b)(Ke,{url:r,className:Q()(a,{old:!0,new:!1,static:!1})}))})):e}]),Kt=Object(l.forwardRef)((function(e,t){var n=Object(l.useState)(null),o=A()(n,2),r=o[0],a=o[1],i=e.html,s=e.css,u=e.options,d=void 0===u?{}:u,f=e.linkCardInfo,p=T()(e,be),h=d.lazyLoadImageOptions,b=d.useGifPortalOption,g=T()(d,ge);Rt(r,h),ut(r);var m=me([ct,lt,s]),v=Object(l.useCallback)(ve(t,a),[]);return Object(c.c)(l.Fragment,{children:[!f&&Object(c.b)($e,{css:lt,root:r}),Dt(r,b),Object(c.b)(bt,{root:r}),Object(c.b)(At,Object.assign({ref:v,html:Wt(i,{linkCardInfo:f}),css:m,root:r,options:g},p))]})})),Vt=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g,Ft=n(66),Ut=n(204),qt=function(e){var t=Object(Ut.b)(),n=Object(l.useCallback)((function(n){t.ZhihuHybrid&&function(e,t){var n=t.root;if(!e.defaultPrevented){var o=e.target;if("img"===o.tagName.toLowerCase()&&(o.src.includes("zhimg")||!o.src.includes("equation"))&&(!o.classList.contains("ztext-gif")||o.parentNode.classList.contains("isPlaying"))){var r=Array.from(n.querySelectorAll(["img"])).filter((function(e){return e.src.includes("zhimg")&&!e.src.includes("equation")})),a=r.indexOf(o);if(-1!==a){e.preventDefault();var i=r.map((function(e){return e.dataset.thumbnail&&e.src.replace(/\.jpg|\.webp/,".gif")||e.dataset.src||e.src||""})).map((function(e){return Object(W.imgUrl)(e,Object.assign({quality:""},e.endsWith("webp")&&{extension:"jpg"}))}));Object(Ft.a)("base/openImage").dispatch({images:i,index:a})}}}}(n,{root:e})}),[e,t.ZhihuHybrid]);Object(l.useEffect)((function(){if(e)return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}}),[e,n])},Ht=n(181);function Zt(e){var t=e.content,n=e.className,o=Object(Ut.b)(),r={"KfeCollection-NovelDisplayBlock-Dark":Object(te.f)().isDarkMode,"KfeCollection-NovelDisplayBlock-Pc":!o.Mobile};return Object(l.useEffect)((function(){var e=Array.from(document.querySelectorAll('img[data-novel="role-image"]')),t=o.Mobile?"openInApp":"zh-lightbox-thumb";e.forEach((function(e){e.className="".concat(e.className," ").concat(t)}))}),[o.Mobile]),s.a.createElement("div",{className:M()("KfeCollection-NovelDisplayBlock",n,r),dangerouslySetInnerHTML:{__html:t}})}Zt.propTypes={content:G.a.string.isRequired};var Qt=Zt,Jt=function(e){var t=e.className,n=e.html,o=e.lazyLoadImageProps,r=Object(l.useState)(null),a=Object(i.a)(r,2),s=a[0],u=a[1];return Rt(s,o),Object(c.b)("div",{ref:u,children:Object(c.b)(Qt,{className:t,content:n})})};var Yt=function(e){var t=this;return e.length?function(n,o){for(var r=e.length-1,a=n;r>=0;)a=e[r].call(t,a,o),r--;return a}:N.a};function Xt(e){var t=e.id,o=e.parentType,r=e.parentId,a=e.suger,i=e.data,c=e.isEditor,l=void 0!==c&&c,s=Object(Y.e)((function(){return Promise.all([n.e(12),n.e(29)]).then(n.bind(null,2859))}),t),u=Object(Y.e)((function(){return n.e(30).then(n.bind(null,2857))}),t);return t.startsWith("fee_")&&u?Object(ne.g)(u,{id:t,isEditor:l}):s?Object(ne.g)(s,{id:t,parentType:o,urlToken:r,suger:a,data:i,isEditor:l}):null}Xt.propTypes={id:G.a.string.isRequired,parentType:G.a.oneOf(["answer","article"]),parentId:G.a.string,suger:G.a.object,data:G.a.object,isEditor:G.a.bool};var $t=Xe({idAttr:"data-ad-id",selector:"a[data-ad-id]",targetClassName:"RichText-ADLinkCardContainer",component:Xt}),en=n(185),tn=n.n(en),nn=function(e){var t=e.referenceList,n=e.onClick,o=e.listRef;return Object(ne.g)(l.Fragment,null,Object(ne.g)("h2",null,"参考"),Object(ne.g)("ol",{className:"ReferenceList",onClick:n,ref:o},tn()(t,"refKey").map((function(e){var n=t.filter((function(t){return t.refKey===e.refKey})),o=n.length>1?Object(ne.g)(s.a.Fragment,null,Object(ne.g)("span",{className:"ReferenceList-backHint","aria-label":"back"},"^"),n.map((function(e,t){var n="".concat(e.refKey,"_").concat(t);return Object(ne.g)("sup",{key:n,className:"ReferenceList-backLink"},Object(ne.g)("a",{href:"#".concat(n),"data-reference-link":!0},"abcdefghijklmnopqrstuvwxyz"[t%26]))}))):Object(ne.g)("a",{className:"ReferenceList-backLink",href:"#".concat(e.refKey,"_0"),"aria-label":"back","data-reference-link":!0},"^");return Object(ne.g)("li",{id:e.refKey,key:e.refKey,tabIndex:0},o,e.text&&Object(ne.g)("span",null,e.text),e.text&&e.url&&" ",e.url&&Object(ne.g)("a",{href:e.url,className:"external",target:"_blank",rel:"noopener noreferrer"},e.url))}))))},on=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g,rn=function(e){return function(t){return function(e,t){if(!e)return e;var n=e,o=[];return n=n.replace(on,(function(e,n){var r=Re(n,{decodeValue:!0}),a=r["data-text"],i=void 0===a?"":a,c=r["data-url"],l=void 0===c?"":c,s=r["data-numero"],u=t?"ref_".concat(t,"_").concat(s):"ref_".concat(s),d=o.filter((function(e){return e.refKey===u})),f="".concat(u,"_").concat(d.length);o.push({refKey:u,text:i,url:l,numero:s});var p=[i,l].filter(Boolean).join(" ");return Object(E.renderToStaticMarkup)(Object(ne.g)("sup",{"data-text":i,"data-url":l,"data-numero":s,"data-draft-node":"inline","data-draft-type":"reference","data-tooltip":p,"data-tooltip-preset":"white","data-tooltip-classname":"ztext-referene-tooltip"},Object(ne.g)("a",{id:f,href:"#".concat(u),"data-reference-link":!0,"aria-labelledby":u},"[",s,"]")))})),o.length?n=n.concat(Object(E.renderToStaticMarkup)(Object(ne.g)(nn,{referenceList:o}))):n}(t,e)}},an=function(e,t){var n=Object(Y.d)((function(n){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.defaultPrevented&&e.target.matches("a[data-reference-link]")){var o=e.target.getAttribute("href"),r=t.querySelector(o);if(r){if(e.preventDefault(),n.onReferenceClick&&e.target.hasAttribute("aria-labelledby"))return void n.onReferenceClick(e);r.focus({preventScroll:!0}),De(r),document.documentElement.setAttribute("data-focus-visible","")}}}(n,e,t)}));Object(l.useEffect)((function(){if(e)return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}}),[e,n])},cn=[{extensionList:["doc","docx","txt"],type:"doc"},{extensionList:["jpg","jpeg","png","bmp"],type:"image"},{extensionList:["mp3","aac"],type:"music"},{extensionList:["pdf"],type:"pdf"},{extensionList:["xls","xlsx","csv"],type:"table"},{extensionList:["torrent"],type:"torrent"},{extensionList:["mp4","flv"],type:"video"},{extensionList:["zip","rar","7z"],type:"zip"},{extensionList:[""],type:"folder"}];function ln(e){var t=e.className,n=e.isDirectory,o=void 0!==n&&n,r=e.extension,a=function(e){return"https://zhstatic.zhihu.com/assets/zhihu-components/file-icon/zhimg_answer_editor_file_".concat(e,".svg")}(o?"folder":function(e){var t=cn.find((function(t){return t.extensionList.includes(e)}));return t?t.type:"other"}(r));return Object(ne.g)("img",{className:M()("FileExtensionIcon",t),src:a})}var sn={baidu:"百度网盘"};function un(e){var t=e.component,n=void 0===t?"a":t,o=e.className,r=e.href,a=e.type,i=void 0===a?"file":a,c=e.name,s=e.extension,u=e.size,d=e.source,f=e.onRef,p=e.onClick,h=e.onMouseDown,b=Number(u);return Object(ne.g)(n,{className:M()("FileLinkCard",o),href:r,target:"_blank",rel:"noopener noreferrer","data-za-detail-view-id":7693,ref:f,onClick:p,onMouseDown:h},Object(ne.g)(ln,{className:"FileLinkCard-icon",isDirectory:"directory"===i,extension:s}),Object(ne.g)("div",{className:"FileLinkCard-info"},Object(ne.g)("div",{className:"FileLinkCard-name"},c),Object(ne.g)("div",{className:"FileLinkCard-meta"},Boolean(b)&&Object(ne.g)("div",{className:"FileLinkCard-size"},Object(U.unitPrefix)(b)),Boolean(b)&&d&&Object(ne.g)(l.Fragment,null," · "),d&&Object(ne.g)("div",{className:"FileLinkCard-source"},function(e){return sn[e]||e}(d)))))}var dn,fn=/<a\b([^>]*data-draft-type="file-link-card"[^>]*)>(.*?)<\/a>/g,pn=function(e){return e?e.replace(fn,(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=Re(t,{decodeValue:!0}),r=o.href,a=void 0===r?"":r,i=o["data-file-type"],c=o["data-file-extension"],l=o["data-file-size"],s=o["data-file-source"],u=Pe(n);return Object(E.renderToStaticMarkup)(Object(ne.g)(un,{href:a,name:u,type:i,extension:c,size:l,source:s}))})):e},hn=function(e){return{alignItems:"center",backgroundColor:e.colorMod(e.colors.GBK10A).alpha(.88),borderRadius:"12px",boxSizing:"border-box",display:"flex",margin:"1em auto",maxWidth:"100%",overflow:"hidden",padding:"12px",position:"relative",width:"390px"}},bn=function(e){return Object.assign({color:e.colors.GBK02A,fontSize:"15px",fontWeight:500,lineHeight:"21px"},Object(te.d)(2))},gn=function(e){return{color:e.colors.GBK06A,fontSize:"12px",display:"flex",lineHeight:"14px",marginTop:"5px"}},mn=n(61),vn=n(2770),On=n(1592),jn=n(994),kn=n(888),Cn=n(2771),xn=n(248),yn=n(244),An=n.n(yn),wn=n(86),Ln=["children","pl","targetId","handleScroll","index"],Sn=["className"],Bn=["className"],zn=["children","targetId","active","setCursor"],Tn=["children","pl","targetId","handleScroll","handleAction","index","status","className","isCollapsed","inEditor","active"],In=["className"],Nn=["className"],En=["isCollapsed","inEditor","catalogRef","contentRoot","catalogLength","contentRootLeft","shouldCollapse"],Rn=function(e){var t=e.children,n=e.pl,o=e.targetId,r=e.handleScroll,a=e.index,i=T()(e,Ln);return Object(c.b)(mn.Text,Object.assign(Object.assign({flexShrink:0,display:"flex",alignItems:"center",color:"GBK02A",fontSize:"12px",height:"20px",lineHeight:"19px",css:{"&+.Catalog-FirstLevelTitle":{marginTop:"12px"},"&+.Catalog-SecondLevelTitle":{marginTop:"6px"}}},i),{},{children:Object(c.c)(mn.Flex,{pl:n,css:{cursor:"pointer",alignItems:"center"},"data-catalog-target-id":o,"data-za-detail-view-id":"9745","data-za-detail-view-action":"Click","data-za-detail-view-name":"正文",onClick:function(e){r(e,a)},children:[Object(c.b)(mn.Text,{css:[Object(te.d)(1),{pointerEvents:"none",wordBreak:"break-all"}],dangerouslySetInnerHTML:{__html:t}}),Object(c.b)(vn.a,{size:"20px",css:function(e){var t;return{color:null===(t=e.colors)||void 0===t?void 0:t.GBK08A,flex:"0 0 auto",pointerEvents:"none"}}})]})}))},Gn=function(e){var t=e.className,n=T()(e,Sn);return Object(c.b)(Rn,Object.assign({className:M()(t,"Catalog-FirstLevelTitle"),fontWeight:"bold",css:{"&+.Catalog-FirstLevelTitle":{marginTop:"12px"},"&+.Catalog-SecondLevelTitle":{marginTop:"6px"}}},n))},Pn=s.a.forwardRef((function(e,t){var n=e.isFold,o=e.onClick,r=n?On.a:jn.a,a=n?"展开目录":"收起目录";return Object(c.c)(c.a,{children:[Boolean(n)&&Object(c.b)("div",{className:"bottom-shadow",css:function(e){return{position:"absolute",bottom:"25px",width:"100%",height:"40px",background:"linear-gradient(to bottom, ".concat(e.colorMod(e.colors.GBK99A).alpha(0),", ").concat(e.colors.GBK99A,")")}}}),Object(c.c)(mn.Flex,{ref:t,alignItems:"center",justifyContent:"center",height:"25px",fontSize:"12px",color:"GBL05A",css:{cursor:"pointer"},onClick:o,children:[a,Object(c.b)(r,{size:18,css:{marginTop:"1px"}})]})]})})),Mn={1:Gn,2:function(e){var t=e.className,n=T()(e,Bn);return Object(c.b)(Rn,Object.assign({className:M()(t,"Catalog-SecondLevelTitle"),pl:"10px",css:{"&+.Catalog-FirstLevelTitle":{marginTop:"12px"},"&+.Catalog-SecondLevelTitle":{marginTop:"0px"}}},n))}},_n=function(e){var t=e.catalog,n=e.className,o=e.canFold,r=e.inEditor,a=e.scrollOffset,i=void 0===a?0:a,s=o&&!r&&(null==t?void 0:t.length)>3,u=Object(l.useCallback)((function(e,t){if(r){var n=document.querySelector(".DraftEditor-editorContainer");if(n){var o=Array.from(n.querySelectorAll("h2,h3"))[t];o&&requestAnimationFrame((function(){return De(o,i)}))}}}),[r,i]);return null!=t&&t.length?Object(c.c)(mn.Box,{className:M()(n,"Catalog"),mb:"48px",css:{"& .Catalog-wrapper":{position:"relative"}},"data-za-detail-view-name":"正文",children:[Object(c.b)("h2",{css:{marginBottom:"18px !important",marginTop:"0px !important"},children:"目录"}),Object(c.c)(mn.Box,{className:"Catalog-wrapper",children:[Object(c.b)(mn.Flex,{className:"Catalog-content",flexDirection:"column",fontSize:"12px",overflow:"hidden",height:s?"84px":"auto",children:t.map((function(e){var t=e.titleLevel,n=e.text,o=e.targetId,r=e.index,a=Mn[t]||Gn;return Object(c.b)(a,{targetId:o,handleScroll:u,index:r,children:n},String([o,r]))}))}),Boolean(s)&&Object(c.b)(Pn,{isFold:!0})]})]}):r?Object(c.c)(mn.Flex,{flexDirection:"column",alignItems:"center",mb:"18px",children:[Object(c.b)(mn.Box,{size:"160px",mb:"10px",children:Object(c.b)(mn.Image,{size:"100%",src:"https://pic1.zhimg.com/v2-acf70e51e6f95a027a65a9209fd6a330_r.png"})}),Object(c.b)(mn.Text,{color:"GBK06A",fontSize:"17px",lineHeight:"24px",textAlign:"center",children:"在内容中设置标题将会在此处同步展示"})]}):null},Dn=function(e){var t=e.contentHTML,n=Object(l.useState)(!0),o=A()(n,2),r=o[0],a=o[1],i=Object(Y.d)((function(){a(!r)}));return Object(c.c)(J.b,{block:"ZTextCatalog",children:[Object(c.b)(J.e,{as:mn.Flex,zaType:"Block",className:"Catalog-content",flexDirection:"column",css:{fontSize:"12px",overflow:"hidden"},style:{height:r?"84px":"auto"},dangerouslySetInnerHTML:{__html:t}}),Object(c.b)(J.a,{as:Pn,zaType:"Button",zaAction:r?"Expand":"Collapse",isFold:r,onClick:i})]})},Wn=function(e){var t=e.root,n=Object(l.useState)(null),o=A()(n,2),r=o[0],a=o[1];return Object(l.useEffect)((function(){if(t){var e=t.querySelector(".Catalog-wrapper");if(e&&e.querySelector(".bottom-shadow")){var n=e.querySelector(".Catalog-content").innerHTML,o=document.createElement("div");o.className="Catalog-wrapper",e.parentNode.replaceChild(o,e),a(Object(ee.createPortal)(Object(c.b)(Dn,{contentHTML:n}),o))}}}),[t]),r},Kn="removed",Vn="added",Fn=/<(h2|h3)[^>]*>(.*?)<\/\1>/g,Un={h2:1,h3:2},qn=function(e,t){return"h_".concat(e||"editor","_").concat(t)},Hn=function(e){return e.replace(Vt,"").replace(/<[^>]*>/g,"")},Zn=function(e){return Un[e]},Qn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e)return{catalog:[],html:e};var o=[];return t=t||"editor",n="function"==typeof n?n:function(){return String(n)},e=e.replace(Fn,(function(e,r){var a,i,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=Hn(c),s=Zn(r),u=qn(t,o.length),d=(null===(a=e.match(/(data-into-catalog-status=\\{0,1}"\S{1,}\\{0,1}")/))||void 0===a||null===(i=a[0])||void 0===i?void 0:i.indexOf(Kn))>-1?Kn:"";return o.push({text:l,titleLevel:s,Tag:r,targetId:u,status:d}),n({text:l,titleLevel:s,targetId:u,Tag:r,originText:c,status:d})})),{catalog:o,html:e}},Jn=function(e){var t=e.originText,n=e.targetId,o=e.Tag,r=e.status;return Object(E.renderToStaticMarkup)(Object(c.b)(o,{id:n,"data-into-catalog-status":r,dangerouslySetInnerHTML:{__html:t}}))},Yn=function(e){return function(t,n){var o=n.sourceId,r=n.theme,a=n.shouldShowCatalog,i=n.shouldFoldCatalog;if(!t)return t;if(!a)return t;var l=Qn(t,o,Jn),s=l.catalog,u=l.html;return s.length?e?u:Object(E.renderToStaticMarkup)(Object(c.b)(xn.a,{theme:r,children:Object(c.b)(_n,{catalog:s,canFold:i})})).concat(u):u}},Xn=function(e,t,n){var o=Object(J.i)().trackEvent,r=Object(l.useCallback)((function(r){!function(e,t,n,o){if(!e.defaultPrevented){var r=e.target.getAttribute("data-catalog-target-id");if(r){n({action:"OpenUrl",block:"ZTextCatalog",eventType:"Click",elementLocation:{type:"Button",text:e.target.innerText}},{link:{url:window.location.href}}),$.a.trackEvent(e.target);var a=t.querySelector("#"+r);a&&(e.preventDefault(),De(a,10+o,!1))}}}(r,t||e,o,n)}),[e,t,o,n]);Object(l.useEffect)((function(){if(e)return e.addEventListener("click",r),function(){e.removeEventListener("click",r)}}),[e,r])},$n=function(e){var t=e.children,n=e.targetId,o=e.active,r=e.setCursor,a=T()(e,zn);return Object(c.b)(J.a,Object.assign(Object.assign({as:mn.Text,zaType:"Text",color:o?"GBL01A":"GBK02A",fontWeight:o?"bold":"normal",css:{fontSize:"14px"}},a),{},{children:Object(c.c)(mn.Flex,{css:{cursor:"pointer",alignItems:"center",height:"48px"},sx:{borderBottom:"1px solid",borderColor:"GBK09A"},onClick:function(){var e=document.querySelector("#"+n);r(n),e&&De(e)},children:[Object(c.b)(mn.Text,{css:Object(te.d)(1),children:t}),Object(c.b)(kn.a,{size:"24px",css:function(e){return{color:e.colors.GBL05A,flex:"0 0 auto",marginLeft:"auto"}}})]})}))},eo=function(e){return Object(c.b)($n,Object.assign({},e))},to={1:eo,2:function(e){return Object(c.b)($n,Object.assign({pl:"20px"},e))}},no=function(e){var t=e.catalog,n=e.className,o=Object(l.useState)(null),r=A()(o,2),a=r[0],i=r[1];return Object(l.useEffect)((function(){if(null!=t&&t.length){var e=null,n=Me();t.forEach((function(t){var o=document.querySelector("#"+t.targetId);(null==o?void 0:o.getBoundingClientRect().top)<=n+2&&(e=t.targetId)})),i(e)}}),[]),null!=t&&t.length?Object(c.b)(J.b,{block:"Popup",children:Object(c.b)(J.e,{zaType:"Popup",as:mn.Box,className:M()(n),children:Object(c.b)(mn.Flex,{flexDirection:"column",css:{fontSize:"12px"},children:t.map((function(e){var t=e.titleLevel,n=e.text,o=e.targetId,r=to[t]||eo;return Object(c.b)(r,{targetId:o,active:a===o,setCursor:i,children:n},o)}))})})}):null},oo=function(e){var t=e.className,n=e.shown,o=e.onClose,r=e.zaContent,a=e.catalog;return Object(c.b)(wn.b,{wrapperClassName:"CatalogModal-wrapper",className:M()("CatalogModal",t),title:"目录",onClose:o,children:n&&Object(c.b)(no,{css:{paddingBottom:"16px"},catalog:a,zaContent:r})})},ro=function(e){var t=e.children,n=e.pl,o=e.targetId,r=e.handleScroll,a=e.handleAction,i=e.index,l=e.status,s=e.className,u=e.isCollapsed,d=e.inEditor,f=e.active,p=T()(e,Tn);return Object(c.b)(J.a,Object.assign(Object.assign({as:mn.Text,zaType:"Text",className:M()(s,"Catalog-Title"),flexShrink:0,display:"flex",alignItems:"center",color:"GBL05A",fontSize:"12px",height:"20px",lineHeight:"20px",pl:"30px",css:function(e){return{position:"relative",height:"30px",lineHeight:"30px","&.Catalog-FirstLevelTitle, &.Catalog-SecondLevelTitle":{position:"relative",height:"30px",color:f?e.colors.GBL01A:e.colors.GBL05A,"&::before":{content:'" "',position:"absolute",backgroundColor:f?e.colors.GBL01A:e.colors.GBL05A,display:"inline-block",borderRadius:"50%",top:"12px",marginRight:"12px"},"&:hover::before":{backgroundColor:e.colors.GBL01A}},"&.Catalog-FirstLevelTitle::before":{left:u?"78px":"16px",width:"6px",height:"6px"},"&.Catalog-SecondLevelTitle::before":{left:u?"79px":"17px",width:"4px",height:"4px"},".Catalog-TitleIcon":Object.assign({position:"absolute",right:"10px",width:"12px",height:"12px",objectFit:"contain"},("toAdd"!==l||!t)&&{display:"none"}),"&::after":{content:'" "',display:"block",position:"absolute",left:u?"81px":"19px",top:0,transform:"translateX(-50%)",width:"2px",height:"40px",marginTop:"12px",background:e.colorMod(e.colors.GBL05A).alpha(.12)},"&:last-child":{"&::after":{height:0}}}}},p),{},{onClick:function(e){r(e,i)},children:!u&&Object(c.c)(mn.Flex,{px:"10px",ml:n,css:function(e){return Object.assign(Object.assign({cursor:"pointer",alignItems:"center",width:"100%"},"toAdd"===l&&Boolean(t)&&{color:e.colors.GBL01A,background:e.colors.GBK09A,borderRadius:"4px"}),{},{"&:hover":{color:e.colors.GBL01A,background:e.colors.GBK09A,borderRadius:"4px",".Catalog-TitleIcon":{display:"block"}}})},"data-catalog-target-id":o,"data-za-detail-view-id":"9745","data-za-detail-view-action":"Click","data-za-detail-view-name":"正文",children:[Object(c.b)(mn.Text,{css:[Object(te.d)(1),{pointerEvents:"none",wordBreak:"break-all",width:"calc(100% - 22px)"}],dangerouslySetInnerHTML:{__html:t}}),d&&("toAdd"===l?Object(c.b)(mn.Image,{src:"https://pic3.zhimg.com/v2-b01c062116d91b98059d7c90bb1139d2.png",className:"Catalog-TitleIcon",onClick:function(e){e.stopPropagation(),a(e,i,Vn)}}):Object(c.b)(mn.Image,{src:"https://pic2.zhimg.com/v2-4bf4e045dbe37447d257b72b5a79b05c.png",className:"Catalog-TitleIcon",onClick:function(e){e.stopPropagation(),a(e,i,Kn)}}))]})}))},ao=function(e){var t=e.className,n=T()(e,In);return Object(c.b)(ro,Object.assign({className:M()(t,"Catalog-FirstLevelTitle"),fontWeight:"500",css:{"&+.Catalog-FirstLevelTitle":{marginTop:"4px"},"&+.Catalog-SecondLevelTitle":{marginTop:"4px"}}},n))},io={1:ao,2:function(e){var t=e.className,n=T()(e,Nn);return Object(c.b)(ro,Object.assign({className:M()(t,"Catalog-SecondLevelTitle"),pl:"10px",fontWeight:"400",css:{"&+.Catalog-FirstLevelTitle":{marginTop:"4px"},"&+.Catalog-SecondLevelTitle":{marginTop:"4px"}}},n))}},co=function(){return Object(c.c)(mn.Flex,{flexDirection:"column",alignItems:"center",mb:"18px",children:[Object(c.b)(mn.Box,{size:"160px",mb:"10px",children:Object(c.b)(mn.Image,{size:"100%",src:"https://pic1.zhimg.com/v2-acf70e51e6f95a027a65a9209fd6a330_r.png"})}),Object(c.b)(mn.Text,{color:"GBK05A",fontSize:"12px",lineHeight:"19px",textAlign:"center",children:"在内容中设置标题会在此展示"})]})},lo=function(e){var t=e.isCollapsed,n=e.isCollapsedChange,o=e.contentRootLeft,r=e.inEditor,a=e.onClose,i=e.setShownCatalogModal,l=e.shouldCollapse;return Object(c.c)(mn.Flex,{px:"10px",py:"8px",bg:"GBK99A",alignItems:"center",justifyContent:"space-between",color:"GBL05A",css:Object.assign({width:"100%",height:"40px",borderRadius:t?!r&&!l&&o>=190?"4px 0px 0px 4px":"0px 4px 4px 0px":"4px",zIndex:"1",boxShadow:"0px 1px 3px rgba(18, 18, 18, 0.1)"},t&&(l||o<190)?{position:"relative",top:"50px"}:{position:"sticky",top:"0"}),children:[Object(c.c)(mn.Flex,{alignItems:"center",children:[Object(c.b)(Cn.a,{size:15,text:!0,center:!0}),Object(c.b)(J.c,{as:mn.Text,zaType:"Button",zaText:!0,shouldTrackShow:!0,shouldTrackClick:t,ml:"10px",fontSize:"14px",css:t&&{cursor:"pointer",whiteSpace:"nowrap"},onClick:function(){t&&(l||o<190?i(!0):n(!1))},children:t&&!r&&!l&&o>=190?"展开目录":"目录"})]}),r&&Object(c.b)(mn.Image,{src:"https://pic1.zhimg.com/v2-6264c104a2b3efcd0bd3c4876232aec3.png",onClick:a,css:{width:"15px",height:"15px",cursor:"pointer"}}),!r&&!t&&Object(c.b)(J.a,{as:mn.Text,zaType:"Button",zaText:"收起目录",p:"2px 6px",bg:"GBK10A",color:"GBL05A",fontSize:"12px",lineHeight:"16px",css:{borderRadius:"10px",cursor:"pointer"},onClick:function(){n(!0)},children:"收起"})]})},so=function(e){var t,n,o=e.isCollapsed,r=e.inEditor,a=e.catalogRef,i=e.contentRoot,s=e.catalogLength,u=e.contentRootLeft,d=e.shouldCollapse,f=T()(e,En),p=Object(l.useState)(0),h=A()(p,2),b=h[0],g=h[1];return Object(l.useEffect)((function(){var e,t=null===(e=a.current)||void 0===e?void 0:e.clientHeight;r||g(-t)}),[a,r,u]),Object(l.useEffect)((function(){if(r)if(0===s)-267!==b&&g(-267);else{var e=76+34*s,t=parseInt(getComputedStyle(a.current).maxHeight),n=-Math.min(t,e);b!==n&&g(n)}}),[r,s,a,b]),r||i?(r?(t=180,n=-180):u<190||d?(t=76,n=-20):o?(t=100,n=-120):n=-(t=Math.min(u-40,250))-30,Object(c.b)(J.b,{block:r?"EditPage":"AnswerPage",children:Object(c.b)(J.e,Object.assign({ref:a,zaType:"Block",as:mn.Box,css:{position:"sticky",top:0,width:t,marginLeft:n,marginBottom:b,zIndex:1}},f))})):null},uo=function(e){var t=e.catalogContainerRef,n=e.isShowScrollerArrow,o=e.catalog,r=e.isCollapsed,a=e.cursor,i=e.handleScroll,s=e.handleAction,u=e.inEditor,d=e.maskGradientColor,f=Object(l.useState)(!1),p=A()(f,2),h=p[0],b=p[1],g=Object(l.useState)(!1),m=A()(g,2),v=m[0],O=m[1],j=An()((function(){var e;(null===(e=t.current)||void 0===e?void 0:e.scrollTop)<20?b(!1):b(!0);var n=t.current||{},o=n.scrollHeight,r=n.clientHeight,a=n.scrollTop;O(!(o-r-a<20))}),100);return Object(l.useEffect)((function(){var e=t.current;if(e)return e.addEventListener("scroll",j),function(){return e.removeEventListener("scroll",j)}}),[t,j]),Object(c.b)(mn.Box,{mt:"20px",ref:t,css:function(e){return Object.assign({maxHeight:"calc(100vh - 200px)",overflow:"scroll",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},n&&{"&::before, &::after":{content:'" "',position:"absolute",width:"calc(100% - 15px)",height:"36px",pointerEvents:"none",marginLeft:"15px",zIndex:1,transition:"opacity .2s ease-in-out"},"&::before":{opacity:h?1:0,top:"60px",background:"linear-gradient(180deg, ".concat(e.colors[d]," 0%, ").concat(e.colorMod(e.colors[d]).alpha(0)," 100%)")},"&::after":{opacity:v?1:0,bottom:"20px",background:"linear-gradient(180deg, ".concat(e.colorMod(e.colors[d]).alpha(0)," 0%, ").concat(e.colors[d]," 100%)")}})},children:Object(c.b)(mn.Flex,{className:"Catalog-content",flexDirection:"column",fontSize:"12px",children:o.map((function(e){var t=e.titleLevel,n=e.text,o=e.targetId,l=e.status,d=e.index,f=io[t]||ao;return l!==Kn?Object(c.b)(f,{targetId:o,handleScroll:i,handleAction:s,index:d,status:l,isCollapsed:r,inEditor:u,active:a===(o||d),children:n},String([o,d])):null}))})})},fo=function(e){var t=e.catalog,n=e.className,o=e.inEditor,r=e.scrollOffset,a=void 0===r?0:r,i=e.onClose,s=e.contentRoot,u=e.onChange,d=e.catalogRef,f=e.shouldCollapse,p=e.maskGradientColor,h=void 0===p?"GBK10A":p,b=Object(l.useRef)(),g=Object(l.useRef)(),m=d||b,v=Object(l.useState)(!o),O=A()(v,2),j=O[0],k=O[1],C=Object(l.useState)(0),x=A()(C,2),y=x[0],w=x[1],L=Object(l.useState)(!1),S=A()(L,2),B=S[0],z=S[1],T=Object(l.useState)(null),I=A()(T,2),N=I[0],E=I[1],R=Object(l.useState)(!1),G=A()(R,2),P=G[0],_=G[1];Xn(null==m?void 0:m.current,s,a);var D=Object(l.useCallback)((function(e,t){if(o){var n=document.querySelector(".DraftEditor-editorContainer");if(n){var r=Array.from(n.querySelectorAll("h2,h3"))[t];r&&requestAnimationFrame((function(){return De(r,a)}))}}}),[o,a]),W=Object(l.useCallback)((function(e,n,o){var r=document.querySelector(".DraftEditor-editorContainer");if(r){var a=Array.from(r.querySelectorAll("h2,h3"))[n].getAttribute("data-offset-key").split("-")[0];t[n].status=Kn,u(a,o)}}),[t,u]);Object(l.useEffect)((function(){if(!f&&s){var e=s.getBoundingClientRect().left;w(e),e>=190&&k(!1)}}),[s,f]);var K=null==g?void 0:g.current;Object(l.useEffect)((function(){K&&K.scrollHeight>K.clientHeight&&_(!0)}),[K]);var V=Object(l.useMemo)((function(){return null==t?void 0:t.filter((function(e){return e.status!==Kn}))}),[t]),F=V.length,U=An()((function(){var e,n,r,a;if(!F||o||j||(r=null,a=Me(),t.forEach((function(e){if(e.status!==Kn){var t=document.querySelector("#"+e.targetId);(null==t?void 0:t.getBoundingClientRect().top)<=a+2&&(r=e.targetId)}})),r!==N&&(E(r),null===(n=document.querySelector('[data-catalog-target-id="'.concat(r,'"]')))||void 0===n||n.scrollIntoViewIfNeeded())),null!=m&&m.current){var i=null!=s?s:null==m||null===(e=m.current)||void 0===e?void 0:e.parentElement;if(i&&null!=m&&m.current){var c=i.getBoundingClientRect(),l=c.bottom,u=c.height,d=getComputedStyle(i),f=d.paddingTop,p=d.marginTop,h=m.current.getBoundingClientRect(),b=h.bottom,g=h.height;l-b<Math.min(0,u-(g+parseInt(f)+parseInt(p)))?m.current.style.visibility="hidden":m.current.style.visibility="visible"}}}),100);return Object(l.useEffect)((function(){return document.addEventListener("scroll",U),function(){document.removeEventListener("scroll",U)}}),[s,U]),o||F&&s?Object(c.c)(so,{catalogRef:m,catalogLength:F,inEditor:o,isCollapsed:j,contentRoot:s,contentRootLeft:y,shouldCollapse:f,className:M()(n,"Catalog","isCatalogV2",{isCollapsed:j}),pb:"20px","data-za-detail-view-name":"正文",children:[Object(c.b)(lo,{inEditor:o,isCollapsed:j,contentRootLeft:y,setShownCatalogModal:z,shouldCollapse:f,isCollapsedChange:k,onClose:i}),(y>=190||f||o)&&(F?Object(c.b)(uo,{catalogContainerRef:g,isShowScrollerArrow:P,catalog:t,isCollapsed:j,cursor:N,handleScroll:D,handleAction:W,inEditor:o,maskGradientColor:h}):Object(c.b)(co,{})),Object(c.b)(oo,{shown:B,catalog:V,onClose:function(){return z(!1)}})]}):null},po=n(1154),ho=n(1249),bo=n(64),go=Xe({idAttr:"data-mcn-id",selector:"a[data-mcn-id]",targetClassName:"RichText-MCNLinkCardContainer",component:po.a}),mo=function(e){var t=e.contentType,n=e.token,o=e.root,r=e.mcnLinkCardProps,a=e.isAuthor,i=e.urlOrigin,c=void 0===i?"":i,s=Object(l.useState)(null),u=A()(s,2),d=u[0],f=u[1],p=Object(l.useState)(!1),h=A()(p,2),b=h[0],g=h[1];return Object(l.useEffect)((function(){var e=o&&o.querySelector("*[data-draft-type=mcn-link-card]");["answer","article"].includes(t)&&e&&it("".concat(c,"/api/v4/mcn/v2/linkcards?content_type=").concat(t,"&token=").concat(n)).then((function(e){var t=e.data;t&&(f(t),g(!0))})).catch((function(){g(!0)}))}),[o]),b&&Object(bo.jsx)(ho.a,{children:Object(bo.jsx)(go,Object.assign(Object.assign({},r),{},{originalData:d,root:o,isAuthor:a}))})},vo=n(209),Oo=n.n(vo),jo=n(58),ko=n.n(jo),Co=n(1054),xo=n(206),yo=n(1245),Ao=n(939),wo=["id","shouldUseOldLinkCard"];function Lo(e){var t=String(e);return t.length<2&&(t="0"+t),t}function So(e){if(!Number.isFinite(e))return"";var t=(e=Math.floor(e))%60,n=Math.floor(e/60);return"".concat(Lo(n),":").concat(Lo(t))}var Bo=function(){return{borderRadius:"8px",boxSizing:"border-box",display:"block",margin:"1em auto",maxWidth:"100%",overflow:"hidden",position:"relative","&,&:hover":{border:"none !important",color:"inherit !important",textDecoration:"none"}}},zo=function(){return{position:"relative",paddingBottom:"56%"}},To=function(){return{left:"0",height:"100%",position:"absolute",top:"0",width:"100%"}},Io=function(){return{backgroundSize:"cover",backgroundPosition:"center",position:"relative",paddingBottom:"56%"}},No=function(){return{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"60px"}},Eo=function(){return{bottom:"10px",color:"#fff",fontSize:"14px",lineHeight:"16px",position:"absolute",right:"12px"}},Ro=function(e){return{backgroundColor:e.colors.GBK10A,padding:"12px"}},Go=function(e){return{color:e.colors.GBK02A,fontSize:"16px",lineHeight:"22px",fontWeight:e.fontWeights.bold}},Po=function(e){return{alignItems:"center",color:e.colors.GBK06A,display:"flex",fontSize:"14px",lineHeight:"20px",marginTop:"6px"}},Mo=function(){return{height:"20px",marginRight:"8px",width:"20px"}},_o=function(e){return{background:e.colors.GBK10A,borderRadius:"8px",boxSizing:"border-box",display:"block",margin:"1em auto",maxWidth:"100%",overflow:"hidden",paddingBottom:"56%",position:"relative"}},Do=function(e){return{alignItems:"center",color:e.colors.GBK06A,display:"flex",fontSize:"28px",left:"50%",lineHeight:"40px",position:"absolute",textAlign:"center",transform:"translate(-50%, -50%)",top:"50%"}},Wo=Object.freeze({__proto__:null,ZVideoLinkCard:Bo,ZVideoLinkCardPlayerContainer:zo,ZVideoLinkCardPlayer:To,ZVideoLinkCardImage:Io,ZVideoLinkCardPlayIcon:No,ZVideoLinkCardDuration:Eo,ZVideoLinkCardInfo:Ro,ZVideoLinkCardTitle:Go,ZVideoLinkCardAuthor:Po,ZVideoLinkCardAvatar:Mo,ZVideoLinkErrorCard:_o,ZVideoLinkErrorCardMessage:Do}),Ko=function(e){var t,n,o=null==e||null===(t=e.refTo)||void 0===t||null===(n=t.contents)||void 0===n?void 0:n[0];return null==o?void 0:o[null==o?void 0:o.type]},Vo=function(e){var t=e.enableInlinePlay,n=e.onImageClick,o=e.zvideo,r=e.zaButtonText,a=e.getVideoUrl,i=e.zaProps,s=o.imageUrl,u=o.video,d=u.videoId,f=u.duration,p=Object(l.useCallback)((function(e){$.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:r}}),n(e,o)}),[n,o,r]);return Object(c.b)(c.a,{children:t?Object(c.b)(yo.a,{placeholder:Object(c.b)("div",{className:"ZVideoLinkCard-playerContainer",css:zo}),children:Object(c.b)("div",{className:"ZVideoLinkCard-playerContainer",css:zo,children:Object(c.b)(Co.a,{type:"video",className:"ZVideoLinkCard-player",css:To,src:a?a(d):"https://www.zhihu.com/video/".concat(d),iframeProps:{allowFullScreen:!0},zaProps:i})})}):Object(c.c)("div",{className:"ZVideoLinkCard-image",css:Io,style:{backgroundImage:"url(".concat(s,")")},onClick:p,children:[Object(c.b)(Ao.a,{className:"ZVideoLinkCard-playIcon",css:No}),Boolean(f)&&Object(c.b)("div",{className:"ZVideoLinkCard-duration",css:Eo,children:So(f)})]})})},Fo=function(e){var t=e.onInfoClick,n=e.zvideo,o=e.zaButtonText,r=e.showReferenceInfo,a=e.showCoCreationInfo,i=e.subAuthor,s=void 0===i?{}:i,u=n.title,d=n.url,f=n.author,p=n.playCount,h=Object(l.useCallback)((function(e){$.a.trackEvent(e.target,{id:7847,action:"OpenUrl"},{button:{text:o}}),t(e,n)}),[t,n,o]);return Object(c.c)("div",{className:"ZVideoLinkCard-info",css:Ro,onClick:h,children:[Object(c.b)("div",{className:"ZVideoLinkCard-title",css:Go,children:u}),Boolean(d)&&Object(c.c)("div",{className:"ZVideoLinkCard-author",css:Po,children:[a?Object(c.c)(c.a,{children:[Object(c.b)(xo.a,{url:f.avatarUrl,alt:"",size:20,round:!0,css:{zIndex:1}}),Object(c.b)(xo.a,{url:s.avatarUrl,alt:"",size:20,round:!0,css:{marginLeft:-4,marginRight:8}}),Object(c.b)("div",{children:"".concat(f.name,"、").concat(s.name," 联合创作")})]}):Object(c.c)(c.a,{children:[Object(c.b)(xo.a,{className:"ZVideoLinkCard-avatar",css:Mo,url:f.avatarUrl,alt:"",size:20,round:!0}),Object(c.b)("div",{children:r?"".concat(f.name," 引用创作"):Oo()(dn||(dn=m()(["","的视频"])),f.name)})]}),Boolean(p)&&Object(c.c)("div",{children:[" · ",Object(U.cnNiceNumber)(p),"播放"]})]})]})};function Uo(e){var t,n=Object(l.useRef)(null),o=e.component,r=void 0===o?"a":o,a=e.getVideoUrl,i=e.className,s=e.onClick,u=e.onMouseDown,d=e.zvideo,f=e.enableInlinePlay,p=void 0!==f&&f,h=e.onImageClick,b=void 0===h?N.a:h,g=e.onInfoClick,m=void 0===g?N.a:g,v=e.renderInjection,O=e.zaProps,j=d.id,k=d.url,C=d.video,x=C.videoId,y=C.status,A=d.creationRelationship,w=!k?"inlinezvideo":"zvideo",L=Ko(null==A?void 0:A.coCreation),S=Boolean(L),B="ZTextZVideoLinkCard";if(S?B="ZTextCoCreationZVideoLinkCard":(B="ZTextReferenceZVideoLinkCard",t=Boolean(Ko(null==A?void 0:A.reference))),Object(l.useEffect)((function(){v||Object(X.onViewedOnce)(n.current,(function(){$.a.trackCardShow(n.current,{id:7844},{button:{text:w}})}))}),[w,v]),v){if("function"!=typeof v)throw new Error("renderInjection must be function");return v(e)}return"converting_failure"===y?Object(c.b)(qo,{error:"视频转码失败，请重新上传视频"}):Object(c.b)(l.Fragment,{children:Object(c.c)(J.c,{as:r,shouldTrackClick:!0,shouldTrackShow:!0,zaAction:"OpenUrl",zaEventType:"Click",zaBlock:B,zaType:"Card",view:{elementLocation:{content:{type:"Zvideo",id:j},card:{index:0}}},extra:{link:{url:k}},className:M()("ZVideoLinkCard",i),css:Bo,ref:n,href:k,target:"_blank",rel:"noopener noreferrer",onClick:s,onMouseDown:u,"data-za-not-track-link":!0,"data-za-module":"Content","data-za-module-info":JSON.stringify({card:{content:{type:"Zvideo",token:j,video_id:x}}}),children:[Object(c.b)(Vo,{zvideo:d,enableInlinePlay:p,zaButtonText:w,onImageClick:b,getVideoUrl:a,zaProps:Object.assign({token:j},O)}),Object(c.b)(Fo,{zvideo:d,zaButtonText:w,onInfoClick:m,showReferenceInfo:t,showCoCreationInfo:S,subAuthor:null==L?void 0:L.author})]})})}function qo(e){var t=e.error;return Object(c.b)("div",{className:"ZVideoLinkErrorCard",css:_o,children:Object(c.b)("div",{className:"ZVideoLinkErrorCard-message",css:Do,children:t.message||"视频加载错误"})})}function Ho(e){var t=e.id,n=e.shouldUseOldLinkCard,o=T()(e,wo),r=Object(l.useState)(null),a=A()(r,2),i=a[0],s=a[1],u=Object(l.useState)(null),d=A()(u,2),f=d[0],p=d[1];return Object(l.useEffect)((function(){if(n){var e=new URLSearchParams({include:ko()({creation_relationship:!0})}),o="https://www.zhihu.com/api/v4/zvideos/".concat(t,"/card?").concat(e.toString());it(o).then((function(e){return Object(K.camelizeKeys)(e)})).then((function(e){e.error?p(e.error):s(e)})).catch((function(e){p(e)}))}}),[n,t]),n?f?Object(c.b)(qo,{error:f}):i?Object(c.b)(Uo,Object.assign({zvideo:i,css:Wo},o)):null:Object(c.b)(Ye,Object.assign({inEditor:!0,component:"div",href:"https://www.zhihu.com/zvideo/".concat(t)},o))}Ho.defaultProps={shouldUseOldLinkCard:!0};var Zo,Qo=Xe({cardDataFilter:function(e){return Array.from(e.getElementsByTagName("a")).map((function(e){var t,n=e.getAttribute("href"),o="link-card"===e.getAttribute("data-draft-type");if(!n||!o)return null;var r=null===(t=n.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/))||void 0===t?void 0:t[1];if(r){var a=document.createElement("div");return a.className="RichText-ZVideoLinkCardContainer",e.parentNode.replaceChild(a,e),{data:{id:r},target:a}}return null})).filter(Boolean)},component:Ho}),Jo=function(e,t,n){var o=Object(l.useRef)(n),r=Object(Y.d)((function(e){var n=e.currentTarget,o={title:n.dataset.text,href:n.href};"IMG"===e.target.tagName?function(e,t,n){var o;$.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,t,Object.assign(Object.assign({},o),{},{video:{}})):function(e,t,n){var o;$.a.trackEvent(e.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==t||null===(o=t.onImageClick)||void 0===o||o.call(t,e,n)}(e,t,o)}));Object(l.useEffect)((function(){if(e&&o.current){var t=Array.from(e.querySelectorAll(".LinkCard.new.static.zvideo"));return t.forEach((function(e){Object(X.onViewedOnce)(e,(function(){return t=e,void $.a.trackCardShow(t,{id:7844},{button:{text:"inlinezvideo"}});var t})),e.addEventListener("click",r)})),function(){t.forEach((function(e){e.removeEventListener("click",r)}))}}}),[e,o,r])},Yo=["id","useOpenArticleButton","enableZa","styleAbParam"],Xo=function(e){return{position:"relative",width:"100%",maxWidth:"390px",fontSize:"15px",lineHeight:"21px",padding:"12px 12px 7px",background:e.colors.GBK10A,borderRadius:"8px",margin:"1em auto",boxSizing:"border-box"}},$o=function(){return Object.assign(Object.assign({marginTop:"8px"},Object(te.d)(3)),{},{"& p:first-of-type":{marginTop:"0"},"& p:last-of-type":{marginBottom:"0"}})},er=function(){return Object.assign({},Object(te.d)(10))},tr=function(e){return{padding:"12px",background:e.colors.GBK99A,textAlign:"justify",position:"relative","&::before":{display:"block",content:"' '",position:"absolute",top:"-50%",right:"-50%",bottom:"-50%",left:"-50%",pointerEvents:"none",transform:"scale(0.5, 0.5)",border:"1px solid ".concat(e.colors.GBK08A),borderRadius:"8px"}}},nr=function(){return{display:"flex",justifyContent:"space-between",marginBottom:"12px",fontSize:"13px",lineHeight:"16px"}},or=function(e){return{display:"flex",alignItems:"center",color:e.colors.GBK06A}},rr=function(){return{width:"16px",height:"16px",borderRadius:"50%",marginRight:"6px"}},ar=function(e){return{color:e.colors.GBL01A}},ir=function(e){return{color:e.colors.GBL05A}},cr=function(e){return{padding:"0 0 0 10px",background:e.colors.GBK99A,borderLeft:"4px solid ".concat(e.colors.GBK09A),borderRadius:"0",fontSize:"17px",lineHeight:"28px",textAlign:"justify"}},lr=function(e){return{marginTop:"4px",fontSize:"15px",lineHeight:"21px",color:e.colors.GBK06A}},sr=function(){return{marginTop:"12px"}},ur=function(e){return{marginTop:"6px",lineHeight:1,color:e.colors.GBL01A}},dr=function(){return{width:"100%",height:"135px",marginTop:"8px",objectPosition:"center",objectFit:"cover"}},fr=dr,pr=function(e){return Object.assign(Object.assign({color:e.colors.GBK02A},Object(te.d)(2)),{},{fontWeight:e.fontWeights.bold})},hr=function(){return Object.assign(Object.assign({marginTop:"10px"},Object(te.d)(3)),{},{"@media (min-width: 768px)":Object.assign({},Object(te.d)(8))})},br=function(){return{marginTop:"10px",width:"100%",height:"0",position:"relative",paddingTop:"56%"}},gr=function(){return{position:"absolute",top:"0",width:"100%",height:"100%",objectPosition:"center",objectFit:"cover"}},mr=function(){return{display:"flex",justifyContent:"space-between",height:"40px",width:"100%",alignItems:"center"}},vr=function(e){return{display:"flex",height:"50px",background:"linear-gradient(".concat(e.colorMod(e.colors.GBK10A).alpha(0),",").concat(e.colorMod(e.colors.GBK10A).alpha(1),")"),position:"absolute",bottom:"44px",width:"calc(100% - 24px)"}},Or=function(e){return{fontSize:"14px",color:e.colors.GBK06A}},jr=function(e){return{fontSize:"14px",color:e.colors.GBL01A}},kr=function(e){return{margin:"1em auto",width:"100%",maxWidth:"390px",background:e.colors.GBK10A,borderRadius:"8px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"15px",color:e.colors.GBK07A}},Cr=kr,xr=function(e){var t=e.authorName,n=e.voteupCount;return Object(ne.g)(l.Fragment,null,Oo()(Zo||(Zo=m()(["","的文章"])),t),n>=100&&" · ".concat(Object(U.cnNiceNumber)(n),"赞同"))};function yr(e){var t=e.cardRef,n=e.useOpenArticleButton,o=e.handleClickLink,r=e.title,a=e.excerptText,i=e.imgUrlSrc,c=e.voteupCount,l=e.commentCount;return Object(ne.g)("div",{className:"ArticleLinkCard",css:Xo,ref:t},Object(ne.g)("span",{className:"ArticleLinkCard-title",css:pr},r),Boolean(a)&&Object(ne.g)("div",{className:"ArticleLinkCard-excerpt",css:hr},a),i&&Object(ne.g)("div",{className:"ArticleLinkCard-imageWrapper",css:br},Object(ne.g)("img",{src:Object(W.imgUrl)(i,"540x300"),className:"ArticleLinkCard-image",css:gr,alt:""})),Object(ne.g)("div",{className:"ArticleLinkCard-bottom",css:mr},Object(ne.g)("span",{className:"ArticleLinkCard-hint",css:Or},"".concat(Object(U.cnNiceNumber)(c),"赞同 · ").concat(Object(U.cnNiceNumber)(l),"评论")),n&&Object(ne.g)("span",{onClick:o,className:"ArticleLinkCard-hybridLink",css:jr},"查看完整文章")),Object(ne.g)("div",{className:"ArticleLinkCard-bottomCardGradient",css:vr}))}function Ar(e){var t=e.cardRef,n=e.useOpenArticleButton,o=e.handleClickLink,r=e.title,a=e.content,i=e.imgUrlSrc,c=e.voteupCount,l=e.authorName,s=e.avatarUrl;return Object(ne.g)("div",{className:"ArticleLinkCard AvatarArticleLinkCard",css:me([Xo,tr]),ref:t},Object(ne.g)("div",{className:"AvatarArticleLinkCard-info",css:nr},Object(ne.g)("div",{className:"AvatarArticleLinkCard-hint",css:or},s&&Object(ne.g)("img",{className:"AvatarArticleLinkCard-avatar",css:rr,src:s,alt:""}),Object(ne.g)(xr,{authorName:l,voteupCount:c})),n&&Object(ne.g)("span",{onClick:o,className:"AvatarArticleLinkCard-hybridLink",css:ar},"查看全文")),Object(ne.g)("span",{className:"ArticleLinkCard-title",css:pr},r),Object(ne.g)("div",{className:M()("ArticleLinkCard-content",{"ArticleLinkCard-content--noImg":!i}),css:me([$o,!i&&er])},Object(ne.g)("div",{dangerouslySetInnerHTML:{__html:a}})),!i&&Object(ne.g)("span",{className:"AvatarArticleLinkCard-more",css:ir},"更多内容"),i&&Object(ne.g)("img",{className:"AvatarArticleLinkCard-image",css:dr,src:i,alt:""}))}function wr(e){var t=e.cardRef,n=e.useOpenArticleButton,o=e.handleClickLink,r=e.title,a=e.content,i=e.imgUrlSrc,c=e.voteupCount,l=e.authorName;return Object(ne.g)("div",{className:"ArticleLinkCard QuoteArticleLinkCard",css:me([Xo,cr]),ref:t},Object(ne.g)("span",{className:"ArticleLinkCard-title",css:pr},r),Object(ne.g)("div",{className:"QuoteArticleLinkCard-hint",css:lr},Object(ne.g)(xr,{authorName:l,voteupCount:c})),Object(ne.g)("div",{className:M()("ArticleLinkCard-content QuoteArticleLinkCard-content",{"ArticleLinkCard-content--noImg":!i}),css:me([$o,sr,!i&&er])},Object(ne.g)("div",{dangerouslySetInnerHTML:{__html:a}})),!i&&n&&Object(ne.g)("div",{onClick:o,className:"QuoteArticleLinkCard-hybridLink",css:ur},"查看全文"),i&&Object(ne.g)("img",{className:"QuoteArticleLinkCard-image",css:fr,src:i,alt:""}))}function Lr(e){var t=e.article,n=t.title,o=t.excerpt,r=t.content,a=t.imageUrl,i=t.voteupCount,c=t.commentCount,s=t.author,u=void 0===s?{}:s,d=e.styleAbParam,f=e.cardRef,p=e.useOpenArticleButton,h=e.handleClickLink,b=Object(l.useMemo)((function(){var e=document.createElement("div");return e.innerHTML=o,e.textContent}),[o]),g=u.name,m=u.avatarUrl;return"1"===d?Object(ne.g)(Ar,{cardRef:f,useOpenArticleButton:p,handleClickLink:h,title:n,content:r,imgUrlSrc:a,voteupCount:i,authorName:g,avatarUrl:m}):"2"===d?Object(ne.g)(wr,{cardRef:f,useOpenArticleButton:p,handleClickLink:h,title:n,content:r,imgUrlSrc:a,voteupCount:i,authorName:g}):Object(ne.g)(yr,{cardRef:f,useOpenArticleButton:p,handleClickLink:h,title:n,excerptText:b,imgUrlSrc:a,voteupCount:i,commentCount:c})}var Sr=function(e){var t=e.article.id,n=e.article,o=e.useOpenArticleButton,r=e.enableZa,a=e.styleAbParam,i=Object(l.useRef)(null);Object(l.useEffect)((function(){r&&($.a.setModule(i.current,{module:"Content"},{card:{content:{type:"Post",token:String(t)}}}),$.a.trackCardShow(i.current,{id:8589,element:"Card"}))}),[r,t]);var c="https://zhuanlan.zhihu.com/p/".concat(t),s=Object(l.useCallback)((function(){r&&$.a.trackEvent(i.current,{id:8590,action:"OpenUrl",element:"Card"})}),[r]);return Object(ne.g)(J.c,{as:"a",shouldTrackShow:!0,shouldTrackClick:!0,zaBlock:"ZTextArticleLinkCard",zaAction:"OpenUrl",zaType:"Button",zaEventType:"Click",extra:{link:{url:c}},href:c,"data-za-not-track-link":!0,onClick:s,rel:"noopener noreferrer",target:"_blank"},Object(ne.g)(Lr,{styleAbParam:a,cardRef:i,useOpenArticleButton:o,linkUrl:c,handleClickLink:s,article:n}))},Br=Xe({cardDataFilter:function(e){return Array.from(e.getElementsByTagName("a")).map((function(e){var t,n=e.getAttribute("href"),o="link-card"===e.getAttribute("data-draft-type"),r="normal"===e.getAttribute("data-size");if(!n||!o||!r)return null;var a=null===(t=n.match(/https:\/\/zhuanlan.zhihu.com\/p\/(\d+)$/))||void 0===t?void 0:t[1];if(a){var i=document.createElement("div");return i.className="RichText-ArticleLinkCardContainer",e.parentNode.replaceChild(i,e),{data:{id:a},target:i}}return null})).filter(Boolean)},component:function(e){var t=e.id,n=e.useOpenArticleButton,o=e.enableZa,r=e.styleAbParam,a=T()(e,Yo),i=Object(l.useState)(null),c=A()(i,2),s=c[0],u=c[1],d=Object(l.useState)(null),f=A()(d,2),p=f[0],h=f[1],b=r&&["1","2"].includes(r)?"1":"0";return Object(l.useEffect)((function(){var e="https://www.zhihu.com/api/v4/articles/".concat(t,"?is_article_card=").concat(b);it(e).then((function(e){return Object(K.camelizeKeys)(e)})).then((function(e){e.error?h(e.error.message):u(e)})).catch((function(e){h(e.message||"未知错误")}))}),[t,b]),p?Object(ne.g)("div",{className:"ArticleLinkCard-error",css:Cr},p):s?Object(ne.g)(Sr,Object.assign({article:s,useOpenArticleButton:n,enableZa:o,styleAbParam:r},a)):Object(ne.g)("div",{className:"ArticleLinkCard-loading",css:kr},"加载中...")}}),zr=n(942),Tr=n.n(zr),Ir=Xe({idAttr:"data-sku-id",selector:"a[data-sku-id]",targetClassName:"RichText-MkSkuLinkCardContainer",component:function(e){var t=e.id,n=e.onClick,o=Object(l.useRef)(!1),r=Object(l.useState)({}),a=A()(r,2),i=a[0],c=a[1],s=Object(l.useState)(!1),u=A()(s,2),d=u[0],f=u[1];return Object(l.useEffect)((function(){it("https://www.zhihu.com/api/v4/market/km_sku_card/".concat(t),{credentials:"same-origin"}).then((function(e){var n=Object(K.camelizeKeys)(e)||{},o=n.title,r=n.desc,a=n.cover,i=n.button,l=n.resourceId,s=n.resourceName,u=n.price,d=n.error,p={};!Tr()(e)&&Tr()(d)&&(p=b()({},t,{id:t,skuId:l,source:2,productType:1,cardType:"cpsCommonCard",goods:{title:o,subtitle:r,price:{price:u},goodsImg:{imgUrl:a,imgShape:"rectangle",cornerText:s},goodsUrl:{url:null==i?void 0:i.url},btnText:"去查看"}})),c(p),f(!0)})).catch((function(){f(!0)}))}),[]),d&&!Tr()(i)?Object(bo.jsx)(ho.a,{children:Object(bo.jsx)(po.a,Object.assign(Object.assign({id:t,ref:function(e){e&&!e.classList.contains("GoodsRecommendCard-placeholder")&&!1===o.current&&($.a.setModule(e,{module:"Content"},{card:{content:{id:t}}}),Object(X.onViewedOnce)(e,(function(){$.a.trackCardShow(e,{id:7203})})),o.current=!0)},originalBlockText:"ZTextMkSKuLinkCard",originalData:i},{cardSize:"large",enableBackdrop:!1,sourceConvert:!1,tagPreset:"plain",enableMetaTag:!1,enableButton:!0,buttonPreset:"plain",buttonColor:"orange",enableHint:!1}),{},{onClick:function(e){$.a.trackEvent(e.target,{id:7204,action:"OpenUrl"}),n&&n(e)}}))}):null}}),Nr=n(42),Er=n.n(Nr),Rr=["onRef","htmlProcessors","linkCardInfo","shouldUseArticleCard","articleLinkCardProps","zvideoLinkCardProps","adLinkCardProps","mcnLinkCardProps","mkSkuLinkCardProps","html","sourceId","shouldShowCatalog","shouldCatalogCollapse","shouldFoldCatalog","referenceLinkProps","lazyLoadImageProps","newLinkCardAb","useGifProps","useCatalogV2","isAuthor","maskGradientColor"],Gr=function(e){var t=e.onRef,n=e.htmlProcessors,o=void 0===n?[]:n,s=e.linkCardInfo,u=e.shouldUseArticleCard,d=e.articleLinkCardProps,f=e.zvideoLinkCardProps,p=e.adLinkCardProps,h=e.mcnLinkCardProps,b=e.mkSkuLinkCardProps,g=e.html,m=e.sourceId,v=e.shouldShowCatalog,O=e.shouldCatalogCollapse,j=e.shouldFoldCatalog,k=e.referenceLinkProps,C=e.lazyLoadImageProps,x=e.newLinkCardAb,y=e.useGifProps,A=e.useCatalogV2,w=e.isAuthor,L=e.maskGradientColor,S=Object(a.default)(e,Rr),B=p||{},z=B.parentType,T=B.parentId,I=Object(l.useState)(null),N=Object(i.a)(I,2),E=N[0],R=N[1],G=Object(te.f)(),P=Yt([].concat(Object(r.a)(o),[rn(),pn,Yn(A)]));Jo(E,f,s),an(E,k),Xn(E),function(e){Object(l.useEffect)((function(){e&&Array.from(e.querySelectorAll("img[eeimg]")).forEach((function(e){e.setAttribute("data-formula",e.alt),e.alt="[公式]"}))}),[e])}(E);var M=Object(Y.d)((function(e){return"https://".concat(Er.a.videoHost,"/video/").concat(e,"?").concat(new URLSearchParams([["itemId",T],["itemType",z]]))})),_=!(Number(x)>0)&&Object(c.c)(c.a,{children:[u&&Object(c.b)(Br,Object.assign(Object.assign({},d),{},{root:E})),Object(c.b)(Qo,Object.assign(Object.assign({getVideoUrl:M},f),{},{root:E}))]}),D=Object(l.useMemo)((function(){return Qn(g,m)}),[g,m]).catalog;return Object(c.c)(c.a,{children:[v&&j&&Object(c.b)(Wn,{root:E}),Object(c.b)($t,Object.assign(Object.assign({},p),{},{root:E})),Object(c.b)(Ir,Object.assign(Object.assign({},b),{},{root:E})),_,mo({root:E,mcnLinkCardProps:h,contentType:z,token:T,isAuthor:w}),v&&A&&(null==D?void 0:D.length)>0&&Object(c.b)(fo,{catalog:D,inEditor:!1,scrollOffset:52,contentRoot:E,shouldCollapse:O,maskGradientColor:L}),Object(c.b)(Kt,Object.assign({ref:Object(Y.h)(t,R),options:{lazyLoadImageOptions:C,useGifPortalOption:y},css:function(e){return function(e){return{".FileLinkCard":hn(e),".FileLinkCard-icon":{flexShrink:0,height:"30px",width:"30px"},".FileLinkCard-info":{marginLeft:"12px"},".FileLinkCard-name":bn(e),".FileLinkCard-meta":gn(e),".FileLinkCard-source":{whiteSpace:"pre"}}}(e)},html:P(g,{sourceId:m,theme:G,shouldShowCatalog:v,shouldFoldCatalog:j,newLinkCardAb:x,linkCardInfo:s})},S))]})},Pr=n(899),Mr=function(e){var t=e.getAttribute("data-hash"),n=e.textContent.replace(/^@/,""),o=document.createElement("span");return e.parentNode.replaceChild(o,e),{target:o,data:{id:t,name:n}}},_r=function(e){var t=Object(l.useState)(null),n=Object(i.a)(t,2),o=n[0],r=n[1];return Object(l.useEffect)((function(){if(e){var t=Array.from(e.querySelectorAll(".member_mention"));if(t.length){var n=t.map(Mr).map((function(e,t){var n=e.data,o=e.target;return Object(ee.createPortal)(Object(c.c)(Pr.a,{user:n,children:["@",n.name]},t),o)}));r(n)}}}),[e]),o},Dr=n(1130),Wr=function(e){var t=e.getAttribute("data-poster"),n="data:,"===t?"":t,o={title:e.getAttribute("data-name"),thumbnail:n,url:e.getAttribute("href"),src:e.getAttribute("data-src")};o=e.getAttribute("data-lens-id")?Object.assign(Object.assign({},o),{},{isLens:!0,id:e.getAttribute("data-lens-id"),isPlayable:!0}):Object.assign(Object.assign({},o),{},{isLens:!1,id:e.getAttribute("data-video-id"),isPlayable:"true"===e.getAttribute("data-video-playable")}),e.hasAttribute("data-lens-status")&&(o=Object.assign(Object.assign({},o),{},{error:{status:e.getAttribute("data-lens-status"),message:e.getAttribute("data-description")}}));var r=document.createElement("div");return e.parentNode.replaceChild(r,e),{target:r,data:o}},Kr=function(e){var t=Object(l.useState)(null),n=Object(i.a)(t,2),o=n[0],r=n[1];return Object(l.useEffect)((function(){if(e){var t=Array.from(e.querySelectorAll(".video-box, .video-link, .unprocessable_video"));if(t.length){var n=t.map(Wr).map((function(e,t){var n=e.data,o=e.target;return Object(ee.createPortal)(Object(c.b)(Dr.a,{data:n},t),o)}));r(n)}}}),[e]),o},Vr=n(80),Fr=n.n(Vr),Ur=["params","onRequestOpen","extra","as"],qr=function(e){return/^(\w+:)?\/\//.test(e)?e:location.origin+e},Hr=function(e,t){var n=t.params,o=t.onRequestOpen,r=Object(Ut.b)();return function(t){var a=e.href,i=e.onClick;if(i&&i(t),!t.defaultPrevented&&a){var c=function(e,t){if(!t)return e;var n=e.split("#"),o=A()(n,2),r=o[0],a=o[1],i=r+(r.includes("?")?"&":"?")+t;return a?i+"#"+a:i}(qr(a),n);if(null!=r&&r.ZhihuHybrid||null!=r&&r.Zhihu)return t.preventDefault(),void Ft.a.dispatch("base/openURL",{url:c});null!=o&&o({ua:r,url:c})&&t.preventDefault()}}},Zr=function(e,t){var n=t.extra;return{zaType:"Button",zaAction:"OpenUrl",zaEventType:"Click",shouldTrackClick:Boolean(e),extra:Fr()({link:{get url(){return qr(e)}}},n)}},Qr=Object(l.forwardRef)((function(e,t){var n=e.params,o=e.onRequestOpen,r=e.extra,a=e.as,i=void 0===a?mn.Link:a,c=T()(e,Ur);return Object(bo.jsx)(J.c,Object.assign(Object.assign(Object.assign({as:i},Zr(c.href,{extra:r})),c),{},{ref:t,onClick:Hr(c,{params:n,onRequestOpen:o})}))})),Jr=function(e){var t=e.size,n=e.className;return Object(c.b)("svg",{width:t,height:t,viewBox:"0 0 8 8",className:n,children:Object(c.b)("path",{d:"M3.16668 1.375C2.91355 1.375 2.70835 1.5802 2.70835 1.83333C2.70835 2.08646 2.91355 2.29167 3.16668 2.29167H5.06017L1.59994 5.75189C1.42095 5.93088 1.42095 6.22108 1.59994 6.40007C1.77893 6.57906 2.06913 6.57906 2.24812 6.40007L5.70835 2.93985V4.83333C5.70835 5.08646 5.91355 5.29167 6.16668 5.29167C6.41981 5.29167 6.62502 5.08646 6.62502 4.83333V1.83333C6.62502 1.5802 6.41981 1.375 6.16668 1.375H3.16668Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.25",strokeLinecap:"round",strokeLinejoin:"round"})})},Yr=function(e){var t=e.size,n=e.className;return Object(c.b)("svg",{width:t,height:t,viewBox:"0 0 15 15",className:n,children:Object(c.b)("path",{d:"M10.89 9.477l3.06 3.059a1 1 0 0 1-1.414 1.414l-3.06-3.06a6 6 0 1 1 1.414-1.414zM6 10a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",fill:"currentColor"})})},Xr=function(e){var t=e.word,n=e.sourceType,o=e.sourceId,r=e.link,a=void 0===r?{linkType:0,linkUrl:"",topicToken:""}:r,i=e.attachedInfoBytes,s=e.entityAB,u=e.hasKnowledgeTopic,d=e.onClick,f=Object(te.f)().colors,p=Object(Ut.b)(),h=p.Zhihu||p.ZhihuHybrid,b=0!==a.linkType,g=1===a.linkType,m=h&&g&&"1"===s,v=Object(l.useMemo)((function(){return b?a.linkUrl:function(e,t,n){var o=new URLSearchParams({q:e,search_source:"Entity",hybrid_search_source:"Entity",hybrid_search_extra:JSON.stringify({sourceType:t,sourceId:n})});return"https://www.zhihu.com/search?".concat(o.toString())}(t,n,o)}),[a,t,n,o]),O=Object(Y.d)((function(e){m&&(e.preventDefault(),function(e,t,n){var o="https://www.zhihu.com/appview/topic/".concat(t,"/knowledge"),r=new URLSearchParams({url:o,show_header:"true",title:e,enable_close:"true",min_percent:"1",enable_drag:String(Boolean(n.iOS))});Object(Ft.a)("base/openURL").dispatch({url:"zhihu://popup_container?".concat(r.toString())})}(t,a.topicToken,p)),d(e,a,v)}));if(!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=0===t.linkType,a=1===t.linkType;return e?"0"===o?r:!n||a:r}(h,a,u,s||"0"))return Object(c.b)(l.Fragment,{children:t});var j=b?Jr:Yr;return Object(c.c)(Qr,{as:h?"span":"a",shouldTrackShow:!0,zaText:t,zaBlock:b?"KnowledgeEntity":"SearchEntity",extra:{attachedInfoBytes:i},"data-za-not-track-link":!0,css:{color:f.GBL01A,textDecoration:"none",cursor:"pointer",":active":{padding:"3.5px 0",backgroundColor:f.GBK09A,borderRadius:"4px"}},href:v,target:"_blank",onClick:O,children:[t,Object(c.b)(j,{size:"8px",css:{position:"relative",verticalAlign:"top",top:"5px"}})]})},$r=function(e,t){var n=t.type,o=t.sourceId,r=t.entityWords,a=void 0===r?[]:r,i=t.entityAB,s=t.onClick,u=void 0===s?N.a:s,d=Object(l.useState)(null),f=A()(d,2),p=f[0],h=f[1],b=Object(Y.d)(u);return Object(l.useEffect)((function(){if(e){var t=Array.from(e.querySelectorAll("span[data-search-entity]"));if(t.length){var r=!1,l=t.map((function(e){var t,n=e.getAttribute("data-search-entity"),o=a[Number(n)]||{},i=o.mention,c=o.link,l={word:i,link:c,attachedInfoBytes:o.attachedInfoBytes};1===(null==c?void 0:c.linkType)&&(r=!0);var s=document.createElement("span");return null===(t=e.parentNode)||void 0===t||t.replaceChild(s,e),{data:l,target:s}})).map((function(t,a){var l=t.data,s=t.target;return e.contains(s)?Object(ee.createPortal)(Object(c.b)(Xr,Object.assign({sourceType:n,sourceId:o,entityAB:i,hasKnowledgeTopic:r,onClick:b},l),a),s):null}));h(l)}}}),[e]),p},ea=n(26),ta=n(146),na=n.n(ta),oa=n(1644),ra=function(e){var t=e.goodsCardId,o=e.handleClose,r=Object(ea.useSelector)((function(e){return e.currentUser})),a=Object(Y.e)((function(){return n.e(31).then(n.bind(null,2850))})),i=Object(oa.a)(),l=Object(Y.d)((function(e){var t=e.id,n=e.sourceId,o=e.url,r=e.app_schema_ios,a=e.app_schema_android;i({id:t,source:n,url:o,appSchemaIos:r,appSchemaAndroid:a})}));return t?Object(c.b)(a,{showModal:Boolean(t),id:t,userId:r,clientId:na.a.get("_zap"),onClose:o,onSelectCard:l}):null},aa=["className","ecommerce","html","shouldUseArticleCard","shouldShowCatalog","sourceId","sourceType","isExpanded","entityWords"],ia=["isNovel"],ca={},la=function(e,t){var n=function(e){return e.split("/").reverse()[0]}(t),o=n.split("."),r=Object(i.a)(o,2),a=r[0],c=r[1],l=a.split("_"),s=Object(i.a)(l,2)[1],u="webp"===c||"gif"===c?c:"image",d=Object(f.statGenerator)({appName:"heifetz"})("".concat(u,".").concat(s,".unknown.RichText"));switch(e){case"loadstart":ca[n]=Date.now();break;case"load":if(ca[n]){var h="".concat(d,".success");p.a.increment({raw:"".concat(h,".count")}),p.a.timing(h,Date.now()-ca[n]),delete ca[n]}break;case"timeout":ca[n]&&(p.a.increment({raw:"".concat(d,".timeout.count")}),delete ca[n]);break;case"error":ca[n]&&(p.a.increment({raw:"".concat(d,".failure.count")}),delete ca[n])}},sa=function(e){return Object(c.b)(Mt,Object.assign(Object.assign({onLoadStateChange:la},e),{},{useMp4:!0}))},ua=function(e){var t=e.root,o=e.ecommerce,r=e.sourceType,a=e.sourceId,i=e.entityWords;return Object(c.c)(c.a,{children:[Kr(t),_r(t),Object(c.b)(Ht.a,{target:"ecommercePortal",replacement:null,children:Object(d.d)(t,{ecommerce:o,getComponent:function(){return Promise.all([n.e(12),n.e(28)]).then(n.bind(null,1332))}})}),$r(t,{type:r,sourceId:a,entityWords:i})]})},da=function(e){var t=e.className,n=e.ecommerce,o=e.html,s=e.shouldUseArticleCard,d=e.shouldShowCatalog,f=e.sourceId,p=e.sourceType,h=e.isExpanded,b=void 0===h||h,g=e.entityWords,m=Object(a.default)(e,aa),v=Object(l.useState)(null),O=Object(i.a)(v,2),j=O[0],k=O[1],C=Object(l.useMemo)((function(){return o?u.compose.apply(void 0,Object(r.a)([(e=g,null!=e&&e.length?function(t){return t?e.reduce((function(e,t,n){var o=t.matchorder,r=t.mention;return function(e,t,n,o){if(null==e||!e.length)return e;for(var r=e.length,a=0,i=0;i<=r;){if(-1===(i=e.indexOf(t,i)))return e;if((a+=1)-1===n)return e.slice(0,i)+o+e.slice(i+t.length);i+=t.length}return e}(e,r,o-1,'<span data-search-entity="'.concat(n,'">').concat(r,"</span>"))}),t):t}:function(e){return e})].filter(Boolean)))(o):"";var e}),[o,g]);qt(j);var x=function(){var e=Object(l.useState)(null),t=Object(i.a)(e,2),n=t[0],o=t[1];return[n,Object(Y.d)((function(e){var t=e.currentTarget.dataset.mcnId;o(t)})),Object(Y.d)((function(){return o(null)}))]}(),y=Object(i.a)(x,3),A=y[0],w=y[1],L=y[2];return Object(c.c)(c.a,{children:[Object(c.b)(Gr,Object.assign(Object.assign({},m),{},{className:t,html:b?C:o,onRef:k,lazyLoadImageProps:{onLoadStateChange:la,useWebP:!1},useGifProps:{Component:sa},adLinkCardProps:{parentId:f,parentType:p},mcnLinkCardProps:{onClick:w},mkSkuLinkCardProps:{cardSize:"large",enableBackdrop:!1,sourceConvert:!1,tagPreset:"plain",enableMetaTag:!1,enableButton:!0,buttonPreset:"plain",buttonColor:"orange",enableHint:!1},zvideoLinkCardProps:{enableInlinePlay:!0},articleLinkCardProps:{enableZa:!0,useOpenArticleButton:!0},shouldUseArticleCard:s,shouldShowCatalog:d,sourceId:f,useCatalogV2:!0})),Object(c.b)(ua,{root:j,ecommerce:n,sourceId:f,sourceType:p,entityWords:g}),Object(c.b)(ra,{goodsCardId:A,handleClose:L})]})};t.a=function(e){var t=e.isNovel,n=Object(a.default)(e,ia);if(t){var o=n.className,r=n.html;return Object(c.b)(Jt,{className:o,html:r,lazyLoadImageProps:{onLoadStateChange:la,useWebP:!1}})}return Object(c.b)(da,Object.assign({},n))}},1130:function(e,t,n){"use strict";var o=n(15),r=n(16),a=n(77),i=n(17),c=n(18),l=n(9),s=n(1),u=n(0),d=n(19),f=n(26),p=n(438),h=n(939),b=n(1131),g=n(35),m=n(997),v=n(29),O=n(260),j=n(415),k=n(369),C=n.n(k),x=function(e,t){return e+(t?Date.now()-t:0)},y=function(e,t){return Math.abs(e-t)<.01},A={auto:"Auto",ld:"LD",sd:"SD",hd:"HD"},w={auto:"自动",ld:"低清",sd:"标清",hd:"超清"},L=[1,2,3,5,8,13];function S(e){var t,n="sd",o=0,r=null,a=0,i=null,c=!1,l=0,s=0;function u(t,c){e(t,Object.assign({play_event_identifier:r,duration:1e3*o,elapsed:x(a,i),video_quality:A[n]},c))}function d(){(++s<15?L.includes(s):s%15==0)&&u({action:"Playing"})}function f(){clearInterval(t)}return{handlePlayEvent:function(e){var n=e.currentTime,c=e.duration;o=c,y(n,0)&&(r=C()(),a=0),i=Date.now(),y(n,0)?u({action:"Play"}):u({action:"ResumePlay"}),s=0,f(),t=setInterval(d,1e3)},handlePauseEvent:function(e){var t=e.currentTime,n=e.duration;i&&(a+=Date.now()-i,i=null),y(t,n)?u({action:"EndPlay"}):u({action:"Pause"}),f()},handleQualityChangeEvent:function(e){var t=e.quality;u({action:"Switch",name:w[t]}),n=t},handleFragmentLoading:function(){c||(l=Date.now())},handleFragmentLoaded:function(){c||(c=!0,u({action:"Load"},{video_load_time:Date.now()-l}))},clearTick:f}}var B=n(42),z=n.n(B);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(c.a)(this,n)}}var I=function(e){Object(i.a)(n,e);var t=T(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).pauseVideoInIframe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.messageHelper.dispatchMessage(e.contentWindow,m.a.PLAYER.PAUSE,{dontApplyOnFullScreen:t})},r.pauseAllOtherVideos=function(){Array.from(document.querySelectorAll("iframe")).filter((function(e){return e!==r.iframe})).forEach((function(e){return r.pauseVideoInIframe(e)}))},r.handleMessage=function(e,t){var n=r.videoTracker,o=n.handlePlayEvent,a=n.handlePauseEvent,i=n.handleQualityChangeEvent,c=n.handleFragmentLoading,l=n.handleFragmentLoaded;switch(e){case m.b.DOM.PLAY:r.pauseAllOtherVideos(),o(t);break;case m.b.DOM.PAUSE:a(t);break;case m.b.PLAYER.QUALITY_CHANGE:i(t);break;case"fragment-loading":c(t);break;case"fragment-loaded":l(t)}},r.handleObserve=function(e){e[0].intersectionRatio<=0&&r.iframe&&r.pauseVideoInIframe(r.iframe,!0)},r.handlePlay=function(){r.props.trackEvent(Object(a.a)(r),{id:5500,action:"Play",element:"Video"})},r.handlePlayFailed=function(){(0,r.props.showNotification)("视频加载失败，请刷新页面重试","red")};var i=e.data;return r.messageHelper=Object(m.c)(i.id,"*",!0),r.videoTracker=S((function(e,t){g.a.trackEvent(Object(a.a)(r),e,{play:t})})),r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.isLens,o=t.id,r=t.playerUrl,a=t.flvPlayerUrl,i=e.loadVideo;n||!o||r||a||i(o);var c=this.messageHelper.subscribeMessage;this.messageSubscription=c(this.handleMessage)}},{key:"componentWillUnmount",value:function(){this.messageSubscription.unsubscribe(),this.videoTracker.clearTick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,o=t.data.error,r=t.onBeforePlay;return Object(s.b)("div",{className:"RichText-video",children:o?Object(s.b)(b.a,Object.assign({},n)):Object(s.b)(p.a,{onObserve:this.handleObserve,children:Object(s.b)(h.b,Object.assign(Object.assign({},n),{},{onIframeRef:function(t){return e.iframe=t},onPlay:this.handlePlay,onPlayFailed:this.handlePlayFailed,onBeforePlay:r}))})})}}]),n}(u.Component);t.a=Object(d.compose)(Object(f.connect)((function(e,t){var n=t.data,o=n.isLens,r=n.id;return o?{data:Object.assign(Object.assign({},t.data),{},{source:"lens",playerUrl:"https://".concat(z.a.videoHost,"/video/").concat(r)})}:{data:e.video.data[r]||t.data}}),{showNotification:v.h,loadVideo:O.c}),Object(j.b)((function(e){var t=e.data,n=t.isLens,o=t.id,r=t.isPlayable;return{module:"VideoItem",content:{type:"Video",sub_type:n?"SelfHosted":"Embedded",video_id:o,is_playable:Boolean(r)},trackCardShow:!0,view:{id:174}}})))(I)},1131:function(e,t,n){"use strict";var o=n(21),r=n.n(o),a=n(23),i=n.n(a),c=n(22),l=n.n(c),s=n(25),u=n.n(s),d=n(14),f=n.n(d),p=n(39),h=n.n(p),b=n(3),g=n.n(b),m=n(0),v=n(939),O=n(7);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=f()(e);if(t){var r=f()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return u()(this,n)}}var k=function(e){l()(n,e);var t=j(n);function n(){return r()(this,n),t.apply(this,arguments)}return i()(n,[{key:"renderThumbnail",value:function(){var e=this.props.error;return Object(O.g)("div",{className:"VideoErrorCard-thumbnail"},Object(O.g)("div",{className:"VideoErrorCard-error"},e.message||"错误"))}},{key:"render",value:function(){var e=this.props,t=e.isLens,n=e.id;return Object(O.g)("div",{className:"VideoErrorCard"},Object(O.g)(v.b,h()({},this.props,t&&{playerUrl:"https://www.zhihu.com/video/".concat(n)},{thumbnail:this.renderThumbnail(),showPlayButton:!1,onBeforePlay:function(){return!1}})))}}]),n}(m.Component);k.propTypes={error:g.a.object.isRequired};t.a=k},1644:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(40),r=n.n(o),a=n(207),i=n.n(a),c=n(0),l=n(74),s=n(996),u=n(1763),d=function(){var e=Object(l.i)().trackEvent;return Object(c.useCallback)(function(){var t=i()(r.a.mark((function t(n){var o,a,i,c,l,d,f,p,h,b,g,m,v,O,j;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n.element,a=n.id,i=n.url,c=n.source,l=n.scenes,d=void 0===l?s.b.Content:l,f=n.utmInfo,p=void 0===f?{}:f,h=n.appSchemaIos,b=n.appSchemaAndroid,g=n.isOpenPopup,m=void 0!==g&&g,v=n.extraInfo,O=void 0===v?{}:v,j=n.onClick,Object(u.a)({element:o,id:a,url:i,source:c,scenes:d,utmInfo:p,appSchemaIos:h,appSchemaAndroid:b,isOpenPopup:m,extraInfo:O,trackEvent:e,onClick:j});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e])}},2221:function(e,t,n){"use strict";(function(t){var o=n(467),r=n(468),a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/,l=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function s(e){return(e||"").toString().replace(l,"")}var u=[["#","hash"],["?","query"],function(e,t){return p(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function f(e){var n,o=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},r={},i=typeof(e=e||o);if("blob:"===e.protocol)r=new b(unescape(e.pathname),{});else if("string"===i)for(n in r=new b(e,{}),d)delete r[n];else if("object"===i){for(n in e)n in d||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=a.test(e.href))}return r}function p(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function h(e,t){e=s(e),t=t||{};var n,o=i.exec(e),r=o[1]?o[1].toLowerCase():"",a=!!o[2],c=!!o[3],l=0;return a?c?(n=o[2]+o[3]+o[4],l=o[2].length+o[3].length):(n=o[2]+o[4],l=o[2].length):c?(n=o[3]+o[4],l=o[3].length):n=o[4],"file:"===r?l>=2&&(n=n.slice(2)):p(r)?n=o[4]:r?a&&(n=n.slice(2)):l>=2&&p(t.protocol)&&(n=o[4]),{protocol:r,slashes:a||p(r),slashesCount:l,rest:n}}function b(e,t,n){if(e=s(e),!(this instanceof b))return new b(e,t,n);var a,i,l,d,g,m,v=u.slice(),O=typeof t,j=this,k=0;for("object"!==O&&"string"!==O&&(n=t,t=null),n&&"function"!=typeof n&&(n=r.parse),a=!(i=h(e||"",t=f(t))).protocol&&!i.slashes,j.slashes=i.slashes||a&&t.slashes,j.protocol=i.protocol||t.protocol||"",e=i.rest,("file:"===i.protocol&&(2!==i.slashesCount||c.test(e))||!i.slashes&&(i.protocol||i.slashesCount<2||!p(j.protocol)))&&(v[3]=[/(.*)/,"pathname"]);k<v.length;k++)"function"!=typeof(d=v[k])?(l=d[0],m=d[1],l!=l?j[m]=e:"string"==typeof l?~(g=e.indexOf(l))&&("number"==typeof d[2]?(j[m]=e.slice(0,g),e=e.slice(g+d[2])):(j[m]=e.slice(g),e=e.slice(0,g))):(g=l.exec(e))&&(j[m]=g[1],e=e.slice(0,g.index)),j[m]=j[m]||a&&d[3]&&t[m]||"",d[4]&&(j[m]=j[m].toLowerCase())):e=d(e,j);n&&(j.query=n(j.query)),a&&t.slashes&&"/"!==j.pathname.charAt(0)&&(""!==j.pathname||""!==t.pathname)&&(j.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=n.length,r=n[o-1],a=!1,i=0;o--;)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),i++):i&&(0===o&&(a=!0),n.splice(o,1),i--);return a&&n.unshift(""),"."!==r&&".."!==r||n.push(""),n.join("/")}(j.pathname,t.pathname)),"/"!==j.pathname.charAt(0)&&p(j.protocol)&&(j.pathname="/"+j.pathname),o(j.port,j.protocol)||(j.host=j.hostname,j.port=""),j.username=j.password="",j.auth&&(d=j.auth.split(":"),j.username=d[0]||"",j.password=d[1]||""),j.origin="file:"!==j.protocol&&p(j.protocol)&&j.host?j.protocol+"//"+j.host:"null",j.href=j.toString()}b.prototype={set:function(e,t,n){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||r.parse)(t)),a[e]=t;break;case"port":a[e]=t,o(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,/:\d+$/.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";a[e]=t.charAt(0)!==i?i+t:t}else a[e]=t;break;default:a[e]=t}for(var c=0;c<u.length;c++){var l=u[c];l[4]&&(a[l[1]]=a[l[1]].toLowerCase())}return a.origin="file:"!==a.protocol&&p(a.protocol)&&a.host?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var a=o+(n.slashes||p(n.protocol)?"//":"");return n.username&&(a+=n.username,n.password&&(a+=":"+n.password),a+="@"),a+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},b.extractProtocol=h,b.location=f,b.trimLeft=s,b.qs=r,e.exports=b}).call(this,n(110))},2222:function(e,t,n){var o;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n=function(){function e(){}function t(e,t){for(var n=t.length,o=0;o<n;++o)r(e,t[o])}e.prototype=Object.create(null);var n={}.hasOwnProperty;var o=/\s+/;function r(e,r){if(r){var a=typeof r;"string"===a?function(e,t){for(var n=t.split(o),r=n.length,a=0;a<r;++a)e[n[a]]=!0}(e,r):Array.isArray(r)?t(e,r):"object"===a?function(e,t){if(t.toString===Object.prototype.toString)for(var o in t)n.call(t,o)&&(e[o]=!!t[o]);else e[t.toString()]=!0}(e,r):"number"===a&&function(e,t){e[t]=!0}(e,r)}}return function(){for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var a=new e;t(a,o);var i=[];for(var c in a)a[c]&&i.push(c);return i.join(" ")}}();e.exports?(n.default=n,e.exports=n):void 0===(o=function(){return n}.apply(t,[]))||(e.exports=o)}()},961:function(e,t,n){"use strict";var o=n(21),r=n.n(o),a=n(23),i=n.n(a),c=n(22),l=n.n(c),s=n(25),u=n.n(s),d=n(14),f=n.n(d),p=n(3),h=n.n(p),b=n(0),g=n.n(b),m=n(12),v=n.n(m),O=n(964),j=n(138),k=n(95),C=n.n(k),x=n(163),y=n(7);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=f()(e);if(t){var r=f()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return u()(this,n)}}var w={top:10,left:20},L={top:0,left:0};var S=function(e){l()(n,e);var t=A(n);function n(){var e;r()(this,n);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).scrollerRef=g.a.createRef(),e.state={transEnded:!1,rect:null,translate:null,scale:null},e.getBoundingClientRect=function(){var t=e.props,n=t.img,o=t.data,r=n.getBoundingClientRect(),a=r.left,i=r.top,c=r.width,l=r.height,s=o.width,u=o.height,d={left:a,top:i,width:c,height:l},f=1;return s>u?(d.height=l,f=l/u,d.width=s*f,d.left=a+(c-d.width)/2,d.top=i+(l-d.height)/2):s<u&&(d.width=c,f=c/s,d.height=u*f,d.left=a+(c-d.width)/2,d.top=i+(l-d.height)/2),d},e.handleClick=function(t){t.stopPropagation(),e.setState({translate:null,scale:null})},e.handleTransitionEnd=function(){var t=e.state,n=t.translate,o=t.scale,r=e.props.onClose;n&&o?(e.setState({transEnded:!0}),e.scrollerRef.current.style.overflow="auto"):r()},e}return i()(n,[{key:"originalSrc",get:function(){return this.props.img.dataset.original}},{key:"currentSrc",get:function(){var e=this.props.img;return e.currentSrc||e.src}},{key:"componentWillMount",value:function(){var e=this.props,t=e.img,n=e.isOriginalUrl;this.originalSrc!==this.currentSrc&&((new Image).src=this.originalSrc);this.setState({rect:!1===n?this.getBoundingClientRect():t.getBoundingClientRect()})}},{key:"componentDidMount",value:function(){var e=this;Object(O.disableBodyScroll)(this.scrollerRef.current);var t=this.props.img;setTimeout((function(){return e.setState(Object.assign({},e.computeTransition(e.state.rect,{width:t.dataset.rawwidth||t.naturalWidth})))}))}},{key:"componentWillUnmount",value:function(){Object(O.enableBodyScroll)(this.scrollerRef.current)}},{key:"computeTransition",value:function(e,t){var n,o=this.props,r=o.transitionType,a=o.data,i=C()(navigator.userAgent).Mobile?L:w,c=i.top,l=i.left,s=window,u={left:0,top:0,width:s.innerWidth,height:s.innerHeight},d=function(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}(u),f={width:u.width-2*l,height:u.height-2*c},p={},h={};return 1===r?(p.width=f.width>a.width?a.width:f.width,n=p.width/a.width,p.height=a.height*n,h={x:(f.width-p.width)/2+l,y:p.height<f.height?(f.height-p.height)/2+c:w.top}):(p.width=f.width>t.width?t.width:f.width,n=p.width/e.width,p.height=e.height*n,h={x:d.x-e.width/2,y:(p.height<f.height?d.y:w.top+p.height/2)-e.height/2}),{translate:h,scale:n}}},{key:"render",value:function(){var e,t=this,n=this.props,o=n.img,r=n.isOriginalUrl,a=n.data,i=n.transitionType,c=n.className,l=this.state,s=l.translate,u=l.scale,d=l.rect,f=l.transEnded,p=s&&u,h=1,b="";if(1===i){var g=(C()(navigator.userAgent).Mobile?L:w).left;e=Math.min(window.innerWidth-2*g,a.width);var m=d.width/e;b=p?"translate(".concat(s.x,"px, ").concat(s.y,"px) scale(1) "):"translate(".concat(d.left,"px, ").concat(d.top,"px) scale(").concat(m,") "),h=p?1:0}else b=p?"translate(".concat(s.x,"px ,").concat(s.y,"px) scale(").concat(u,") "):"translate(".concat(d.left,"px,").concat(d.top,"px)");return Object(y.g)(x.a,null,Object(y.g)("div",{className:v()("ImageView",c,{"is-active":p}),style:{paddingBottom:w.top},onClick:this.handleClick},Object(y.g)("div",{className:"ImageView-inner",ref:this.scrollerRef},Object(y.g)("img",{ref:function(e){t.imgEl=e},src:!1===r?Object(j.imgUrl)(o.dataset.original,"r"):f&&this.originalSrc||this.currentSrc,className:v()("ImageView-img",{"ImageView-transformOrigin":1===i}),style:{width:e||d.width,transform:b,opacity:h},onTransitionEnd:this.handleTransitionEnd,alt:"preview"}))))}}]),n}(b.Component);S.propTypes={img:h.a.object.isRequired,onClose:h.a.func.isRequired};t.a=S},964:function(e,t,n){var o,r,a;r=[t],void 0===(a="function"==typeof(o=function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0});var n=!1;if("undefined"!=typeof window){var o={get passive(){n=!0}};window.addEventListener("testPassive",null,o),window.removeEventListener("testPassive",null,o)}function r(e){return l.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))}function a(e){var t=e||window.event;return!!r(t.target)||1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1)}function i(){setTimeout((function(){void 0!==f&&(document.body.style.paddingRight=f,f=void 0),void 0!==d&&(document.body.style.overflow=d,d=void 0)}))}var c="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints),l=[],s=!1,u=-1,d=void 0,f=void 0;e.disableBodyScroll=function(e,o){if(c){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!l.some((function(t){return t.targetElement===e}))){var i={targetElement:e,options:o||{}};l=[].concat(t(l),[i]),e.ontouchstart=function(e){1===e.targetTouches.length&&(u=e.targetTouches[0].clientY)},e.ontouchmove=function(t){var n,o,i,c;1===t.targetTouches.length&&(o=e,c=(n=t).targetTouches[0].clientY-u,r(n.target)||(o&&0===o.scrollTop&&0<c||(i=o)&&i.scrollHeight-i.scrollTop<=i.clientHeight&&c<0?a(n):n.stopPropagation()))},s||(document.addEventListener("touchmove",a,n?{passive:!1}:void 0),s=!0)}}else{h=o,setTimeout((function(){if(void 0===f){var e=!!h&&!0===h.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(f=document.body.style.paddingRight,document.body.style.paddingRight=t+"px")}void 0===d&&(d=document.body.style.overflow,document.body.style.overflow="hidden")}));var p={targetElement:e,options:o||{}};l=[].concat(t(l),[p])}var h},e.clearAllBodyScrollLocks=function(){c?(l.forEach((function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null})),s&&(document.removeEventListener("touchmove",a,n?{passive:!1}:void 0),s=!1),l=[],u=-1):(i(),l=[])},e.enableBodyScroll=function(e){if(c){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,l=l.filter((function(t){return t.targetElement!==e})),s&&0===l.length&&(document.removeEventListener("touchmove",a,n?{passive:!1}:void 0),s=!1)}else(l=l.filter((function(t){return t.targetElement!==e}))).length||i()}})?o.apply(t,r):o)||(e.exports=a)}}]);
//# sourceMappingURL=main.shared_f30f7459f944e851b885959dfde412e92f3a8d2e.b1b4376782c2e36a3218.js.map